<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.Author="Вадим Чура" ReportOptions.CreateDate="38251.4373884143" ReportOptions.Description.Text="" ReportOptions.Name="Алфавитная книга" ReportOptions.LastChange="42957.6837813542" ReportOptions.VersionMajor="1" ReportOptions.VersionMinor="1" ReportOptions.VersionRelease="1" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  sName,sWhere,strAdd,strType,strTypeName,strLast,strFirst,strYears,sYear1,sYear2,s,s1,s2:String;&#13;&#10;  n,m,i,nObj,nTypeAkt,nMax,nIDZags:Integer;&#13;&#10;  nL,nW:Extended;&#13;&#10;  arrLineG : array[1..6] of TfrxLineView;&#13;&#10;  arrLineF :   array[1..6] of TfrxLineView;&#13;&#10;  lPrintAll:Boolean;                        &#13;&#10;//-------------------------------------------------------------------                                                                                                                                              &#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DialogPage1, Engine do&#13;&#10;  begin&#13;&#10;  nIDZags:=ParamAsInteger('ID');&#13;&#10;&#13;&#10;  nObj:=PropCurGurnal('TYPEEDITOBJ',0);&#13;&#10;  if nObj=0 then begin                                                  &#13;&#10;    s:=trim(GetLastValue('ALFAVIT_TYPE_AKT2','S'));&#13;&#10;    if s='' then edType.ItemIndex:=0  else edType.KeyIndex:=s;&#13;&#10;    if edType.ItemIndex=-1 then edType.ItemIndex:=0;&#13;&#10;  end else begin&#13;&#10;    edType.KeyIndex:=IntToStr(nObj);&#13;&#10;    if edType.ItemIndex=-1 then edType.ItemIndex:=0;&#13;&#10;  end;            &#13;&#10;  edTypeOnChange(nil);                &#13;&#10;//  s:=trim(GetLastValue('ALFAVIT_GOD1','S'));&#13;&#10;//  if s='' then edGod1.Text:=Str(YearOf(DATE)-1) else edGod1.Text:=s;&#13;&#10;&#13;&#10;//  s:=trim(GetLastValue('ALFAVIT_GOD2','S'));&#13;&#10;//  if s='' then edGod2.Text:=Str(YearOf(DATE)-1) else edGod2.Text:=s;&#13;&#10;&#13;&#10;//  cbOrgan.Checked:=GetLastValue('ALFAVIT_cbALLORGAN','L');&#13;&#10;//  cbOrder.Checked:=GetLastValue('ALFAVIT_cbORDER','L');&#13;&#10;    &#13;&#10;//  edOrgan.KeyValue:=nIDZags;&#13;&#10;//  edOrgan.Enabled:=not cbAllOrgan.Checked;&#13;&#10;          &#13;&#10;//  if IdProg()='SELSOVET' then begin&#13;&#10;//    cbNameOrg.Visible:=false;&#13;&#10;//  end else begin&#13;&#10;//    cbNameOrg.Visible:=true;&#13;&#10;//  end;&#13;&#10;  &#13;&#10;//  par1 := FormatDateTime('yyyy-mm-dd',DATE);&#13;&#10;//  messageBox(par1,'');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;//-------------------------------------------------------------------                                                                                                                                              &#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Button1, Engine do&#13;&#10;  begin&#13;&#10;&#13;&#10;  strTypeName:='К';&#13;&#10;  &#13;&#10;  strLast :='';&#13;&#10;  sYear1 := edGod1.text;&#13;&#10;//  sYear2 := edGod2.text;&#13;&#10;  strYears:='';&#13;&#10;  sWhere:='';&#13;&#10;&#13;&#10;  s1:='';&#13;&#10;  s2:='';&#13;&#10;//  if not cbAllOrgan.Checked and (edOrgan.Text&#60;&#62;'') then begin&#13;&#10;//    s1:='id_zags='+VarToStr(edOrgan.KeyValue);&#13;&#10;//    if nIDZags&#60;&#62;edOrgan.KeyValue&#13;&#10;//      then strAdd:='('+edOrgan.Text+')'+CRLF;&#13;&#10;//  end;&#13;&#10;&#13;&#10;  if edPropAkt.Enabled then begin                                          &#13;&#10;    if (edPropAkt.ItemIndex&#62;-1) then begin&#13;&#10;      if edPropAkt.KeyIndex='2' then begin&#13;&#10;        strAdd:=strAdd+'(первичные записи)';&#13;&#10;        s2:='(vosstan is null or vosstan=false)';&#13;&#10;      end;&#13;&#10;      if edPropAkt.KeyIndex='3' then begin&#13;&#10;        strAdd:=strAdd+'(восстановленные записи)';&#13;&#10;        s2:='vosstan=true';&#13;&#10;      end;&#13;&#10;    end;&#13;&#10;  end;&#13;&#10;  if s1='' then begin&#13;&#10;    if s2&#60;&#62;'' then s1:=s2;&#13;&#10;  end else begin&#13;&#10;    if s2&#60;&#62;'' then s1:='('+s1+' and '+s2+')';&#13;&#10;  end;&#13;&#10;  if sYear1&#60;&#62;'' then begin&#13;&#10;    strYears := 'за ' + sYear1 + ' год';&#13;&#10;    sWhere:= 'Year(datez)='+sYear1;&#13;&#10;  end;&#13;&#10;  if s1&#60;&#62;''&#13;&#10;    then if sWhere='' then sWhere:=s1 else sWhere:=sWhere+' and '+s1;&#13;&#10;  if sWhere&#60;&#62;'' then sWhere:=' WHERE '+sWhere;                                                                                   &#13;&#10;  &#13;&#10;  nTypeAkt:=StrToInt(edType.KeyIndex);                        &#13;&#10;  sName:=RunFuncScriptEx('GetNameTableFromTypeObj', [nTypeAkt]);&#13;&#10;    &#13;&#10;  if cbOrgan.Checked then begin&#13;&#10;    Query.SQL.text:='select DATEZ, NOMER, ID_ZAGS, KOLVO, IsNull(s.KNAME, s.NAME) KNAME from '+&#13;&#10;                    '(SELECT DATEZ, NOMER, ID_ZAGS, COUNT(*) KOLVO FROM '+sName+sWhere+&#13;&#10;                    ' GROUP BY 1,2,3 HAVING Count(*)&#62;1) a LEFT JOIN SprNames s ON s.ID=a.ID_ZAGS';    &#13;&#10;    Page2.Visible:=true;                                                              &#13;&#10;    Page1.Visible:=false;                                                              &#13;&#10;  end else begin&#13;&#10;    Query.SQL.text:='SELECT DATEZ, NOMER, COUNT(*) KOLVO FROM '+sName+sWhere+&#13;&#10;                    ' GROUP BY 1,2 HAVING Count(*)&#62;1';&#13;&#10;    Page1.Visible:=true;                                                              &#13;&#10;    Page2.Visible:=false;                                                              &#13;&#10;  end;            &#13;&#10;&#13;&#10;  strType:=ValueKey('KEY_TYPEZAGS_FULL',nTypeAkt);&#13;&#10;    &#13;&#10;  //  ShowMessage(Query.SQL.text);&#13;&#10;  MemoWrite('!!!.sql',Query.SQL.Text);                        &#13;&#10;      &#13;&#10;//  sYear1  := edGod.KeyItems[edGod.ItemIndex];&#13;&#10;//  sMonth := edMonth.KeyItems[edMonth.ItemIndex];&#13;&#10;//  strNameMonth := UpperCase(edMonth.Items[edMonth.ItemIndex]);&#13;&#10;//  strNameDate := LowerCase(strNameMonth) + ' ' + sYear;&#13;&#10;  end;          &#13;&#10;end;&#13;&#10;//-------------------------------------------------------------------                                                                                                                                              &#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;//-------------------------------------------------------------------                                                                                                                                              &#13;&#10;procedure PageHeader1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;//-------------------------------------------------------------------                                                                                                                                              &#13;&#10;procedure MemoVZOnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbAllOrganOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure edTypeOnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  n:=StrToInt(edType.KeyIndex);&#13;&#10;  case n of&#13;&#10;    _TypeObj_ZBrak: begin&#13;&#10;                      edPropAkt.ItemIndex:=1;                                      &#13;&#10;                      edPropAkt.Enabled:=true;                                      &#13;&#10;                    end;&#13;&#10;    _TypeObj_ZRast: begin&#13;&#10;                      edPropAkt.ItemIndex:=0;                                      &#13;&#10;                      edPropAkt.Enabled:=false;                                      &#13;&#10;                    end;&#13;&#10;    _TypeObj_ZRogd,_TypeObj_ZSmert: begin&#13;&#10;                      edPropAkt.ItemIndex:=1;                                      &#13;&#10;                      edPropAkt.Enabled:=true;                                      &#13;&#10;                    end;&#13;&#10;    _TypeObj_ZUstOtc,_TypeObj_ZUstMat,_TypeObj_ZChName,_TypeObj_ZAdopt: begin&#13;&#10;                      edPropAkt.ItemIndex:=0;                                      &#13;&#10;                      edPropAkt.Enabled:=false;                                      &#13;&#10;                    end;&#13;&#10;  end;                              &#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbNameOrgOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403A80203546F7003000108446174617365747301010C2400000020446174615365743D2251756572792220446174615365744E616D653D225175657279220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query" UserName="Query" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT NOMER, DATEZ, ID_ZAGS, Count(*) KOLVO&#13;&#10;  FROM АктыРождений&#13;&#10;  WHERE true=true&#13;&#10;  GROUP BY 1,2,3&#13;&#10;  HAVING Count(*)&#62;1" SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C65667402740470546F7002580A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Дублирование номеров записей актов" Color="-2147483633" Height="214" ClientHeight="176" Left="409" Top="162" Width="442" ClientWidth="426" OnShow="DialogPage1OnShow">
    <TfrxMComboBoxControl Name="edType" Left="133" Top="6" Width="267" Height="29" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Items.Text="о заключении брака&#13;&#10;о расторжении брака&#13;&#10;о рождении&#13;&#10;о смерти&#13;&#10;об установлении отцовства&#13;&#10;об усыновлении&#13;&#10;о перемене имени&#13;&#10;об установлении материнства" KeyItems.Text="5&#13;&#10;11&#13;&#10;6&#13;&#10;7&#13;&#10;8&#13;&#10;12&#13;&#10;13&#13;&#10;18" Style="csDropDownList" Text="о заключении брака" ItemIndex="0" ItemCount="8" NameOpis="KEY_TYPEZAGS_FULL" KeyIndex="5" OnChange="edTypeOnChange"/>
    <TfrxEditControl Name="edGod1" Left="133" Top="37" Width="59" Height="29" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-2147483643" MaxLength="0" PasswordChar="0"/>
    <TfrxButtonControl Name="Button1" Left="224" Top="138" Width="91" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Выполнить" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxLabelControl Name="Label1" Left="13" Top="41" Width="21" Height="16" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Год" Color="-2147483633"/>
    <TfrxButtonControl Name="Button2" Left="333" Top="138" Width="75" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Cancel="True" Caption="Отказ" ModalResult="2"/>
    <TfrxLabelControl Name="Label3" Left="13" Top="9" Width="79" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Записи актов" Color="-2147483633"/>
    <TfrxCheckBoxControl Name="cbOrgan" Left="13" Top="72" Width="333" Height="17" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Включать в запрос орган регистрации" Color="-2147483633" OnClick="cbAllOrganOnClick"/>
    <TfrxMDBLookupComboBox Name="edOrgan" Left="305" Top="99" Width="65" Height="25" ShowHint="True" Visible="False" ListField="NAME" KeyField="ID" NameOpisEdit="LOOKUP_SPRNAMES"/>
    <TfrxMComboBoxControl Name="edPropAkt" Left="13" Top="99" Width="139" Height="25" ShowHint="True" Color="-16777211" Items.Text="Все записи&#13;&#10;Первичные записи&#13;&#10;Восстановленные" KeyItems.Text="1&#13;&#10;2&#13;&#10;3" Style="csDropDownList" Text="Первичные записи" ItemIndex="1" ItemCount="3" NameOpis="KEY_PROP_AKT" KeyIndex="2"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="5.000625" RightMargin="5.000625" TopMargin="5.000625" BottomMargin="5.000625" MirrorMargins="True" Columns="2" ColumnWidth="99.999375" ColumnPositions.Text="0&#13;&#10;99.999375" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Height="44" Left="0" Top="16" Width="755.9012755875">
      <TfrxMemoView Name="Memo1" Left="5" Top="2" Width="371" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="Р”СѓР±Р»РёСЂРѕРІР°РЅРёРµ Р·Р°РїРёСЃРµР№ Р°РєС‚РѕРІ [strType]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="22" Left="0" Top="156" Width="377.95063779375" ColumnWidth="250" ColumnGap="0" DataSet="Query" DataSetName="Query" RowCount="0">
      <TfrxMemoView Name="QueryNOMER" Left="100" Top="1" Width="88" Height="20" ShowHint="False" DataField="NOMER" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Query.&#34;NOMER&#34;]"/>
      <TfrxMemoView Name="QueryDATEZ" Left="8" Top="1" Width="92" Height="20" ShowHint="False" DataField="DATEZ" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" GapX="10" ParentFont="False" Text="[Query.&#34;DATEZ&#34;]"/>
      <TfrxMemoView Name="QueryKOLVO" Left="188" Top="1" Width="53" Height="20" ShowHint="False" DataField="KOLVO" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Query.&#34;KOLVO&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" Height="16" Left="0" Top="120" Width="377.95063779375">
      <TfrxMemoView Name="Memo2" Left="8" Top="0" Width="92" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р°"/>
      <TfrxMemoView Name="Memo3" Left="100" Top="0" Width="88" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРѕРјРµСЂ"/>
      <TfrxMemoView Name="Memo4" Left="188" Top="0" Width="53" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ"/>
    </TfrxHeader>
  </TfrxReportPage>
  <TfrxReportPage Name="Page2" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="10" RightMargin="10" TopMargin="10" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle2" Height="44" Left="0" Top="16" Width="718.1107">
      <TfrxMemoView Name="Memo5" Left="5" Top="2" Width="691" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="Р”СѓР±Р»РёСЂРѕРІР°РЅРёРµ Р·Р°РїРёСЃРµР№ Р°РєС‚РѕРІ [strType]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData2" Height="22" Left="0" Top="156" Width="718.1107" ColumnWidth="250" ColumnGap="0" DataSet="Query" DataSetName="Query" RowCount="0">
      <TfrxMemoView Name="Memo6" Left="100" Top="1" Width="88" Height="20" ShowHint="False" DataField="NOMER" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Query.&#34;NOMER&#34;]"/>
      <TfrxMemoView Name="Memo7" Left="8" Top="1" Width="92" Height="20" ShowHint="False" DataField="DATEZ" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" GapX="10" ParentFont="False" Text="[Query.&#34;DATEZ&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="617" Top="1" Width="53" Height="20" ShowHint="False" DataField="KOLVO" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[Query.&#34;KOLVO&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="188" Top="1" Width="428" Height="20" ShowHint="False" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="[Query.&#34;KNAME&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header2" Height="16" Left="0" Top="120" Width="718.1107">
      <TfrxMemoView Name="Memo9" Left="8" Top="0" Width="92" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р°"/>
      <TfrxMemoView Name="Memo10" Left="100" Top="0" Width="88" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРѕРјРµСЂ"/>
      <TfrxMemoView Name="Memo11" Left="617" Top="0" Width="53" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»-РІРѕ"/>
      <TfrxMemoView Name="Memo13" Left="188" Top="0" Width="429" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЂРіР°РЅ СЂРµРіРёСЃС‚СЂР°С†РёРё"/>
    </TfrxHeader>
  </TfrxReportPage>
</TfrxReport>
