<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40375.6190210764" ReportOptions.Description.Text="" ReportOptions.LastChange="43741.6911795255" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  tb:TAdsTable;                            &#13;&#10;  ds,dsDeti:TDataSet;&#13;&#10;  sName,sDay,s,ss,sWhere:String;&#13;&#10;  v:Variant;&#13;&#10;  nTypeObj,i,nYear,nMonth,nDay:Integer;&#13;&#10;  sl:TStringList;&#13;&#10;  arrDay: array[1..7] of String;                                                               &#13;&#10;  arrM: array[1..12] of String;                                                               &#13;&#10;        &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  arrDay[1]:='понедельник'; arrDay[2]:='вторник'; arrDay[3]:='среда'; arrDay[4]:='четверг'; arrDay[5]:='пятница';&#13;&#10;  arrDay[6]:='суббота'; arrDay[7]:='воскресенье';&#13;&#10;&#13;&#10;  arrM[1]:='японедельник'; arrDay[2]:='вторник'; arrDay[3]:='среда'; arrDay[4]:='четверг'; arrDay[5]:='пятница';&#13;&#10;&#13;&#10;  arrM[1]:='января'; arrM[2]:='февраля'; arrM[3]:='марта'; arrM[4]:='апреля';&#13;&#10;  arrM[5]:='мая';    arrM[6]:='июня'   ; arrM[7]:='июля';  arrM[8]:='августа';&#13;&#10;  arrM[9]:='сентября'; arrM[10]:='октября'; arrM[11]:='ноября'; arrM[12]:='декабря';  &#13;&#10;    &#13;&#10;  nYear:=getLastValue('YEAR','N');  &#13;&#10;  nMonth:=getLastValue('MONTH','N');&#13;&#10;  nTypeObj:=getLastValue('TYPEOBJ','N');&#13;&#10;  if nTypeObj=_TypeObj_ZRast then begin&#13;&#10;    sName:='Расторжение брака';&#13;&#10;    mOn.text:='Он';                                  &#13;&#10;    mOna.text:='Онa';&#13;&#10;   // mBrak.Text:='Расторжение брака';                                    &#13;&#10;  end else begin                                    &#13;&#10;    sName:=GetLastValue('MESTONAME','C');            &#13;&#10;    mOn.text:='Жених';                                  &#13;&#10;    mOna.text:='Невеста';                                  &#13;&#10;   // mBrak.Text:='Заключение брака';                                    &#13;&#10;  end;&#13;&#10;  &#13;&#10;    &#13;&#10;  nDay:=getLastValue('DAY','N');  &#13;&#10;  if nDay&#62;0 then begin&#13;&#10;    sDay:='day='+InttoStr(nDay);                                &#13;&#10;  end else begin&#13;&#10;    sDay:='day&#62;0';                                &#13;&#10;  end;            &#13;&#10;        &#13;&#10;&#13;&#10;//  ds:=dbGetDataSet('dmBase.SprPunkt');&#13;&#10;//  if ds=nil then begin&#13;&#10;//    s:=;&#13;&#10;  Query.Close;&#13;&#10;//  sDate1 := FormatDateTime('yyyy-mm-dd',DateEdit1.Date);&#13;&#10;  sWhere:='p.typeobj='+IntToStr(nTypeObj)+' and '+&#13;&#10;          'p.mesto='+getLastValue('MESTO','C')+' and p.god='+IntToStr(nYear)+' and '+                                                                                        &#13;&#10;          'p.month='+getLastValue('MONTH','C')+ ' and '+sDay+' and p.otkaz=false';&#13;&#10;&#13;&#10;  s:=getLastValue('SELECTED','C');&#13;&#10;  if s&#60;&#62;'' then begin&#13;&#10;    sl:=TStringList.Create;                                                  &#13;&#10;    StrToStrings(s,sl,',',true);&#13;&#10;    if sl.Count&#62;0 then begin                                                         &#13;&#10;      s:=' and (';&#13;&#10;      for i:=0 to sl.Count-1 do begin&#13;&#10;        s:=s+'p.day='+sl.Strings[i]+' or ';&#13;&#10;      end;&#13;&#10;      s:=Copy(s,1,Length(s)-4)+')';&#13;&#10;      sWhere:=sWhere+s;                                          &#13;&#10;    end;&#13;&#10;    sl.Free;                      &#13;&#10;  end;&#13;&#10;//  showmessage(sWhere);                              &#13;&#10;  Query.SQL.text := Replace(Query.SQL.text,'1=1',sWhere);&#13;&#10;  if nTypeObj=_TypeObj_ZRast then begin&#13;&#10;    Query.SQL.text := Replace(Query.SQL.text,'d.mesto','0');&#13;&#10;    Query.SQL.text := Replace(Query.SQL.text,'LEFT JOIN DeclareMarriage','LEFT JOIN DeclareTermMarriage');&#13;&#10;  end;            &#13;&#10;  memowrite('report.sql', Query.SQL.text);                              &#13;&#10;  &#13;&#10;//  if cbTypeMen.ItemIndex=0 then begin    // 18-50&#13;&#10;//    Query1.SQL.text := Replace(Query1.SQL.text,'&#38;_ON_&#38;','(GetVozrast(datez,on_dater)&#60;51)');&#13;&#10;//  end else begin&#13;&#10;//    Query1.SQL.text := Replace(Query1.SQL.text,'&#38;_ON_&#38;','(on_vus=true)');&#13;&#10;//  end;&#13;&#10;&#13;&#10;        &#13;&#10;  {      &#13;&#10;    ds.First;                      &#13;&#10;    s:='yes dataset';&#13;&#10;    ss:=ds.FieldByName('NAME').asString;&#13;&#10;    v:=VarArrayCreate([0,0], varOleStr);&#13;&#10;    v[0]:=6;                      &#13;&#10;    if ds.Locate('ID',v,loCaseInsensitive)     &#13;&#10;      then sss:=ds.FieldByName('NAME').asString  &#13;&#10;      else sss:='-----------';  &#13;&#10;  end;&#13;&#10;  }      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" OnReportPrint="frxReportOnReportPrint" PropData="044C65667403A80203546F7003000108446174617365747301010C4200000020446174615365743D22464D505245445A41504953524153542E667278507265645A617069732220446174615365744E616D653D22667278507265645A617069732200010C3A00000020446174615365743D22464D505245445A41504953524153542E6672785461626C652220446174615365744E616D653D226672785461626C652200010C2400000020446174615365743D2251756572792220446174615365744E616D653D225175657279220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query" UserName="Query" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT p.*, d.nomer, d.datez, d.mesto as mesto_&#13;&#10;FROM  PredZapis p&#13;&#10;LEFT JOIN DeclareMarriage d ON d.id=p.decl_id&#13;&#10;WHERE 1=1&#13;&#10;ORDER BY day, beginr" AdsConnection="dmBase.AdsConnection" SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C656674024C0470546F7002770A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="7.9375" BottomMargin="5.29166666666667" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnAfterPrint="Page1OnAfterPrint" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Height="25" Left="0" Top="16" Width="793.7013">
      <TfrxMemoView Name="Memo1" Left="31" Top="1" Width="722" Height="25" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="[sName], РїСЂРµРґРІР°СЂРёС‚РµР»СЊРЅР°СЏ Р·Р°РїРёСЃСЊ: [LowerCase(ValueKey('KEY_MONTH',getLastValue('MONTH','C')))] [getLastValue('YEAR','C')] РіРѕРґ"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="48" Left="0" Top="160" Width="793.7013" ColumnWidth="0" ColumnGap="0" DataSet="Query" DataSetName="Query" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Mens_ChildFAMILIA" ShiftMode="smDontShift" Left="31" Top="0" Width="70" Height="48" ShowHint="False" StretchMode="smMaxHeight" DataSetName="Mens_Child" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" HAlign="haCenter" ParentFont="False" Text="[FORMATDATETIME('HH:NN',&#60;Query.&#34;BEGINR&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo3" ShiftMode="smDontShift" Left="101" Top="0" Width="339" Height="48" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-21" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" GapX="10" ParentFont="False" Text="[Query.&#34;ON_FIO&#34;]"/>
      <TfrxMemoView Name="Memo6" ShiftMode="smDontShift" Left="440" Top="0" Width="331" Height="48" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-21" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" GapX="10" ParentFont="False" Text="[Query.&#34;ONA_FIO&#34;]"/>
    </TfrxMasterData>
    <TfrxGroupHeader Name="GroupHeader1" Height="40" Left="0" Top="100" Width="793.7013" Condition="Query.&#34;DAY&#34;" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo2" Left="31" Top="20" Width="70" Height="20" ShowHint="False" Color="15658734" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’СЂРµРјСЏ"/>
      <TfrxMemoView Name="mOn" Left="101" Top="20" Width="339" Height="20" ShowHint="False" Color="15658734" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р–РµРЅРёС…"/>
      <TfrxMemoView Name="Memo5" Left="31" Top="0" Width="740" Height="20" ShowHint="False" Color="15658734" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="      [Query.&#34;DAY&#34;] [arrM[nMonth]], [arrDay[DayOfWeekEx(nYear,nMonth,&#60;Query.&#34;DAY&#34;&#62;)]"/>
      <TfrxMemoView Name="mOna" Left="440" Top="20" Width="331" Height="20" ShowHint="False" Color="15658734" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРµРІРµСЃС‚Р°"/>
    </TfrxGroupHeader>
  </TfrxReportPage>
</TfrxReport>
