<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40375.6190210764" ReportOptions.Description.Text="" ReportOptions.LastChange="42397.6828591667" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  tb:TAdsTable;                            &#13;&#10;  ds,dsDeti:TDataSet;&#13;&#10;  s,ss,sss,sbase,sFIO,sDeti:String;&#13;&#10;  v:Variant;                        &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  sss:='&#38;&#38;&#38;&#38;&#38;&#38;&#38;&#38;';  &#13;&#10;  ds:=dbGetDataSet('dmBase.SprPunkt');&#13;&#10;  if ds=nil then begin&#13;&#10;    s:='not dataset';                                                &#13;&#10;    ss:='-----'                                                              &#13;&#10;  end else begin&#13;&#10;    ds.First;                      &#13;&#10;    s:='yes dataset';&#13;&#10;    ss:=ds.FieldByName('NAME').asString;&#13;&#10;    v:=VarArrayCreate([0,0], varOleStr);&#13;&#10;    v[0]:=6;                      &#13;&#10;    if ds.Locate('ID',v,loCaseInsensitive)     &#13;&#10;      then sss:=ds.FieldByName('NAME').asString  &#13;&#10;      else sss:='-----------';  &#13;&#10;  end;&#13;&#10;  tb:=dbGetAdsTable('dmBase.tbMens');&#13;&#10;  sFIO:=tb.FieldByName('FAMILIA').AsString;                                                        &#13;&#10;  sbase:=tb.DataBaseName+'  index: '+tb.IndexName;&#13;&#10;  dsDeti:=ReadDeti(tb.FieldByName('ID').AsString,'Ж',0,16,false);&#13;&#10;  CheckMens(dsDeti,true,1);&#13;&#10;  dsDeti.First;&#13;&#10;  sDeti:='';                        &#13;&#10;  while not dsDeti.Eof do begin&#13;&#10;    if dsDeti.FieldByName('CHECK').asBoolean = true then begin&#13;&#10;      sDeti:=sDeti+dsDeti.FieldByName('OTNOSH_NAME').asString+dsDeti.FieldByName('FAMILIA').asString+',';&#13;&#10;    end;&#13;&#10;    dsDeti.Next;                                            &#13;&#10;  end;&#13;&#10;  dsDeti.Filter:='CHECK';&#13;&#10;  dsDeti.Filtered:=true;&#13;&#10;              &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  dsDeti.Filtered:=false;&#13;&#10;  &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403A80203546F7003000108446174617365747301010C1300000020446174615365744E616D653D224D656E732200010C1900000020446174615365744E616D653D224D656E735F4368696C64220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="0" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnAfterPrint="Page1OnAfterPrint" OnBeforePrint="Page1OnBeforePrint"/>
</TfrxReport>
