<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40375.6190210764" ReportOptions.Description.Text="" ReportOptions.LastChange="43741.691706713" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  tb:TAdsTable;                            &#13;&#10;  ds,dsDeti:TDataSet;&#13;&#10;  sName,s,ss,sGod,sWhere,sdate1,sdate2,sMesto:String;&#13;&#10;  v:Variant;&#13;&#10;  nTypeObj,i,nYear,nMonth:Integer;&#13;&#10;  sl:TStringList;&#13;&#10;  d:TDateTime;                            &#13;&#10;  arrDay: array[1..7] of String;                                                               &#13;&#10;  arrM: array[1..12] of String;                                                               &#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  nYear:=getLastValue('YEAR','N');  &#13;&#10;  nMonth:=getLastValue('MONTH','N');&#13;&#10;  nTypeObj:=getLastValue('TYPEOBJ','N');&#13;&#10;  if nTypeObj=_TypeObj_ZRast then begin&#13;&#10;    sName:='расторжения брака';&#13;&#10;    mOn.text:='Он';                                  &#13;&#10;    mOna.text:='Онa';&#13;&#10;    mBrak.Text:='Расторжение брака';                                    &#13;&#10;  end else begin                                    &#13;&#10;    sName:='заключения брака';            &#13;&#10;    mOn.text:='Жених';                                  &#13;&#10;    mOna.text:='Невеста';                                  &#13;&#10;    mBrak.Text:='Заключение брака';                                    &#13;&#10;  end;&#13;&#10;    &#13;&#10;//  d:=EncodeDate(nYear,nMonth,1);&#13;&#10;  d:=Now;                                &#13;&#10;  d:=IncMonth(d,-1);&#13;&#10;  edGod.Text:=GetLastValue('YEAR','N'); //Str(YearOf(DATE));        &#13;&#10; // showmessage(datepropis(d,3));                                &#13;&#10;//  dateEdit1.Date:=StartOfTheMonth(d);&#13;&#10;//  dateEdit2.Date:=EndOfTheMonth(d);&#13;&#10;end;&#13;&#10;&#13;&#10;    &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;  arrDay[1]:='понедельник'; arrDay[2]:='вторник'; arrDay[3]:='среда'; arrDay[4]:='четверг'; arrDay[5]:='пятница';&#13;&#10;  arrDay[6]:='суббота'; arrDay[7]:='воскресенье';&#13;&#10;&#13;&#10;  arrM[1]:='японедельник'; arrDay[2]:='вторник'; arrDay[3]:='среда'; arrDay[4]:='четверг'; arrDay[5]:='пятница';&#13;&#10;&#13;&#10;  arrM[1]:='января'; arrM[2]:='февраля'; arrM[3]:='марта'; arrM[4]:='апреля';&#13;&#10;  arrM[5]:='мая';    arrM[6]:='июня'   ; arrM[7]:='июля';  arrM[8]:='августа';&#13;&#10;  arrM[9]:='сентября'; arrM[10]:='октября'; arrM[11]:='ноября'; arrM[12]:='декабря';  &#13;&#10;    &#13;&#10;  Query.Close;&#13;&#10;&#13;&#10;//  sDate1 := DatePropis(DateEdit1.Date,5);&#13;&#10;//  sDate2 := DatePropis(DateEdit2.Date,5);&#13;&#10;//  sWhere:='p.dater&#62;='+QStr(FormatDateTime('yyyy-mm-dd',dateEdit1.Date)+' 00:00:00')+&#13;&#10;//     ' and p.dater&#60;='+QStr(FormatDateTime('yyyy-mm-dd',dateEdit2.Date)+' 23:59:59')+;&#13;&#10;  sDate1 := '';&#13;&#10;  sDate2 := '';&#13;&#10;  sGod:=edGod.text;                        &#13;&#10;  sWhere:='p.god='+edGod.text+' and typeobj='+IntToStr(nTypeObj);&#13;&#10;  &#13;&#10;                              &#13;&#10;  Query.SQL.text := Replace(Query.SQL.text,'1=1',sWhere);&#13;&#10;  memowrite('report.sql', Query.SQL.text);                              &#13;&#10; //  showmessage(Query.SQL.text);  &#13;&#10;//  if cbTypeMen.ItemIndex=0 then begin    // 18-50&#13;&#10;//    Query1.SQL.text := Replace(Query1.SQL.text,'&#38;_ON_&#38;','(GetVozrast(datez,on_dater)&#60;51)');&#13;&#10;//  end else begin&#13;&#10;//    Query1.SQL.text := Replace(Query1.SQL.text,'&#38;_ON_&#38;','(on_vus=true)');&#13;&#10;//  end;&#13;&#10;&#13;&#10;        &#13;&#10;  {      &#13;&#10;    ds.First;                      &#13;&#10;    s:='yes dataset';&#13;&#10;    ss:=ds.FieldByName('NAME').asString;&#13;&#10;    v:=VarArrayCreate([0,0], varOleStr);&#13;&#10;    v[0]:=6;                      &#13;&#10;    if ds.Locate('ID',v,loCaseInsensitive)     &#13;&#10;      then sss:=ds.FieldByName('NAME').asString  &#13;&#10;      else sss:='-----------';  &#13;&#10;  end;&#13;&#10;  }      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;procedure MasterData1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if &#60;Query.&#34;MESTO&#34;&#62;=0 then begin&#13;&#10;    sMesto:='';&#13;&#10;  end else begin                                    &#13;&#10;    sMesto:=ValueSpr('sprKomiss-&#62;ID',&#60;Query.&#34;MESTO&#34;&#62;,'NAME');  &#13;&#10;  end;              &#13;&#10;  if &#60;Query.&#34;OTKAZ&#34;&#62;= true then begin&#13;&#10;    sMesto:='отказ от регистрации';                                     &#13;&#10;  end else begin&#13;&#10;  end;            &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" OnReportPrint="frxReportOnReportPrint" PropData="044C65667403A80203546F7003000108446174617365747301010C4200000020446174615365743D22464D505245445A41504953524153542E667278507265645A617069732220446174615365744E616D653D22667278507265645A617069732200010C3A00000020446174615365743D22464D505245445A41504953524153542E6672785461626C652220446174615365744E616D653D226672785461626C652200010C2400000020446174615365743D2251756572792220446174615365744E616D653D225175657279220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query" UserName="Query" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="SELECT p.*, d.nomer, d.datez, d.mesto as mesto_, &#13;&#10;  convert(cast(p.god as SQL_CHAR(4))+'-'+IIF(length(convert(p.month,SQL_VARCHAR))=1,'0'+convert(p.month,SQL_VARCHAR),convert(p.month,SQL_VARCHAR))+'-'+IIF(length(convert(p.day,SQL_VARCHAR))=1,'0'+convert(p.day,SQL_VARCHAR),convert(p.day,SQL_VARCHAR)),SQL_DATE) as DATE_BRAK &#13;&#10;FROM PredZapis p&#13;&#10;LEFT JOIN DeclareMarriage d ON d.id=p.decl_id&#13;&#10;WHERE 1=1 and day&#62;0&#13;&#10;ORDER BY p.god,p.nomer" AdsConnection="dmBase.AdsConnection" SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C656674026F0470546F70027D0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Параметры журнала" Height="174" ClientHeight="136" Left="403" Top="171" Width="244" ClientWidth="228" OnActivate="DialogPage1OnActivate">
    <TfrxLabelControl Name="Label1" Left="47" Top="33" Width="21" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Год" Color="-16777201"/>
    <TfrxButtonControl Name="Button1" Left="24" Top="89" Width="87" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Выполнить" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="127" Top="89" Width="75" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Cancel="True" Caption="Отказ" ModalResult="2"/>
    <TfrxEditControl Name="edGod" Left="104" Top="30" Width="57" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0" Text="2015"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="0" RightMargin="0" TopMargin="7.9375" BottomMargin="5.29166666666667" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnAfterPrint="Page1OnAfterPrint" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Height="25" Left="0" Top="16" Width="1122.52041">
      <TfrxMemoView Name="Memo1" Left="111" Top="1" Width="984" Height="25" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="Р–СѓСЂРЅР°Р» РїСЂРµРґРІР°СЂРёС‚РµР»СЊРЅРѕР№ Р·Р°РїРёСЃРё [sName] РЅР° [sGod] РіРѕРґ"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="20" Left="0" Top="160" Width="1122.52041" OnBeforePrint="MasterData1OnBeforePrint" ColumnWidth="0" ColumnGap="0" DataSet="Query" DataSetName="Query" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Mens_ChildFAMILIA" Left="821" Top="0" Width="42" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataSetName="Mens_Child" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[FORMATDATETIME('HH:NN',&#60;Query.&#34;BEGINR&#34;&#62;)]"/>
      <TfrxMemoView Name="Memo3" Left="258" Top="0" Width="240" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="10" ParentFont="False" VAlign="vaCenter" Text="[Query.&#34;ON_FIO&#34;]"/>
      <TfrxMemoView Name="Memo6" Left="498" Top="0" Width="240" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="10" ParentFont="False" VAlign="vaCenter" Text="[Query.&#34;ONA_FIO&#34;]"/>
      <TfrxMemoView Name="Memo10" Left="165" Top="0" Width="93" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DatePropis(&#60;Query.&#34;DATER&#34;&#62;,3)]"/>
      <TfrxMemoView Name="Memo8" Left="111" Top="0" Width="54" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataSetName="Mens_Child" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Query.&#34;NOMER&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="738" Top="0" Width="83" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[DatePropis(&#60;Query.&#34;DATE_BRAK&#34;&#62;,3)]"/>
      <TfrxMemoView Name="Memo14" Left="863" Top="0" Width="232" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="10" ParentFont="False" VAlign="vaCenter" Text="[sMesto]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header1" Height="40" Left="0" Top="100" Width="1122.52041" ReprintOnNewPage="True">
      <TfrxMemoView Name="Memo2" Left="821" Top="20" Width="42" Height="20" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р’СЂРµРјСЏ"/>
      <TfrxMemoView Name="mOn" Left="258" Top="0" Width="240" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р–РµРЅРёС…"/>
      <TfrxMemoView Name="mOna" Left="498" Top="0" Width="240" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РќРµРІРµСЃС‚Р°"/>
      <TfrxMemoView Name="Memo11" Left="165" Top="0" Width="93" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р° Р·Р°РїРёСЃРё"/>
      <TfrxMemoView Name="Memo9" Left="111" Top="0" Width="54" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="в„–"/>
      <TfrxMemoView Name="Memo13" Left="738" Top="20" Width="83" Height="20" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р”Р°С‚Р°"/>
      <TfrxMemoView Name="Memo15" Left="863" Top="20" Width="232" Height="20" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РњРµСЃС‚Рѕ"/>
      <TfrxMemoView Name="mBrak" Left="738" Top="0" Width="357" Height="20" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Р—Р°РєР»СЋС‡РµРЅРёРµ Р±СЂР°РєР°"/>
    </TfrxHeader>
  </TfrxReportPage>
</TfrxReport>
