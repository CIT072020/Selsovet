<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.Author="Вадим Чура" ReportOptions.CreateDate="38251.4373884143" ReportOptions.Description.Text="" ReportOptions.Name="Запись акта о браке" ReportOptions.LastChange="43826.5200158796" ReportOptions.VersionMajor="1" ReportOptions.VersionMinor="1" ReportOptions.VersionRelease="1" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  DateBegin, DateEnd :TDateTime;&#13;&#10;  sd, strPeriod, ss:String;&#13;&#10;  nAll : Integer;&#13;&#10;      &#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if IDProg()&#60;&#62;'ZAGS' then begin&#13;&#10;    cbAll.Visible:=false;&#13;&#10;  end;&#13;&#10;  edDateBegin.Date:=GetLastValue('RAST_BR_DATE1','D');&#13;&#10;  edDateEnd.Date:=GetLastValue('RAST_BR_DATE2','D');&#13;&#10;  cbAll.Checked:=(GetLastValue('ALL_ZAGS','C')='1');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;//  s := GetAdres('MAIN');&#13;&#10;//  s := ChoiceKey('KEY_TUL');&#13;&#10;//  if Length(s)&#62;0 then begin&#13;&#10;//    ss:=ValueKey('KEY_TUL',s);&#13;&#10;//    Edit1.text:=s+'/'+ss;&#13;&#10;//  end;&#13;&#10;//  MessageBox(Parameters(' main_select'),'');&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  DateBegin := edDateBegin.Date; // FormatDateTime('yyyy-mm-dd',DATE);&#13;&#10;  DateEnd   := edDateEnd.Date;   // FormatDateTime('yyyy-mm-dd',DATE);&#13;&#10;  strPeriod :=  'c ' + FormatDateTime('dd.mm.yyyy',edDateBegin.Date)+'г. по '+FormatDateTime('dd.mm.yyyy',edDateEnd.Date)+'г.';&#13;&#10;  sd:='datez&#62;='+DateToSQL(DateBegin)+' and datez&#60;='+DateToSQL(DateEnd);         &#13;&#10;  nAll   := 0;&#13;&#10;&#13;&#10;  ss:='';&#13;&#10;  if not cbAll.Checked &#13;&#10;    then ss:='id_zags='+Parameters('ID')+' and '+sd            &#13;&#10;    else ss:=sd;&#13;&#10;    &#13;&#10;  Query1.SQL.Text := Replace(Query1.SQL.Text, 'true=true', ss);&#13;&#10;  MemoWrite('report.sql',Query1.SQL.Text);&#13;&#10;    &#13;&#10;  SetLastValue('RAST_BR_DATE1',edDateBegin.Date, 'D');&#13;&#10;  SetLastValue('RAST_BR_DATE2',edDateEnd.Date, 'D');&#13;&#10;  SetLastValue('ALL_ZAGS',cbAll.Checked, 'L');&#13;&#10;&#13;&#10;end;&#13;&#10;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403A80203546F7003000108446174617365747301010C2600000020446174615365743D225175657279312220446174615365744E616D653D22517565727931220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query1" UserName="Query1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select 'Принято всего заявлений' name, count(*) kolvo from DeclareTermMarriage where true=true &#13;&#10;  union all&#13;&#10;select '  Заявлений по взаимному согласию', count(*) from DeclareTermMarriage where type_rast=1 and true=true &#13;&#10;  union all&#13;&#10;select '    не явилось на регистрацию', count(*) from DeclareTermMarriage where type_rast=1 and otkaz=2 and true=true &#13;&#10;  union all&#13;&#10;select '    отказ от регистрации', count(*) from DeclareTermMarriage where type_rast=1 and otkaz=1 and true=true &#13;&#10;  union all&#13;&#10;select '  Заявлений по решению суда', count(*) from DeclareTermMarriage where type_rast=0 and true=true &#13;&#10;  union all&#13;&#10;select 'Cоставлено всего записей акта', count(*) from AktTermMarriage where true=true    &#13;&#10;  union all&#13;&#10;select '  по взаимному согласию', count(*) from AktTermMarriage where type_rast=1 and true=true  &#13;&#10;  union all&#13;&#10;select '    один из супругов не явился на регистрацию', count(*) from AktTermMarriage where type_rast=1 and true=true and ((ON_DOK_TYPE=999 or ONA_DOK_TYPE=999) and (ON_SVID_DATE is null or ONA_SVID_DATE is null or ON_SVID_DATE&#60;&#62;ONA_SVID_DATE))   &#13;&#10;  union all&#13;&#10;select '  по решению суда', count(*) from AktTermMarriage where type_rast=0 and true=true  &#13;&#10;  union all&#13;&#10;select '    один из супругов не явился', count(*) from AktTermMarriage where type_rast=0 and true=true  and (ON_SVID_DATE is null or ONA_SVID_DATE is null or ON_SVID_DATE&#60;&#62;ONA_SVID_DATE)   " SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C65667402750470546F7002460A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Браки по гражданству" Color="-2147483633" Height="175" ClientHeight="137" Left="393" Top="163" Width="306" ClientWidth="290" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="117" Top="105" Width="75" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Получить" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="208" Top="104" Width="75" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Cancel="True" Caption="Отказ" ModalResult="2"/>
    <TfrxDateEditControl Name="edDateBegin" Left="163" Top="19" Width="103" Height="21" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-2147483643" Date="43825" Time="43825" WeekNumbers="False"/>
    <TfrxDateEditControl Name="edDateEnd" Left="163" Top="50" Width="103" Height="21" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Color="-2147483643" Date="43825" Time="43825" WeekNumbers="False"/>
    <TfrxLabelControl Name="Label3" Left="14" Top="21" Width="106" Height="16" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Начальная дата" Color="-2147483633"/>
    <TfrxLabelControl Name="Label4" Left="14" Top="52" Width="97" Height="16" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Конечная дата" Color="-2147483633"/>
    <TfrxCheckBoxControl Name="cbAll" Left="13" Top="79" Width="276" Height="17" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="З/а всех органов регистрации" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" PaperWidth="209.99979167" PaperHeight="297.00008333" PaperSize="256" LeftMargin="21.1666666666667" RightMargin="5.000625" TopMargin="5.000625" BottomMargin="5.000625" Columns="1" ColumnWidth="200.0011875" ColumnPositions.Text="0" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Height="64" Left="0" ParentFont="False" Top="29" Width="694.800448737598">
      <TfrxMemoView Name="Memo3" Left="4" Top="1" Width="621" Height="59" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-21" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РџРѕРґР°РЅР°РЅРЅС‹Рµ Р·Р°СЏРІР»РµРЅРёСЏ Рё СЃРѕСЃС‚Р°РІР»РµРЅРЅС‹Рµ Р·Р°РїРёСЃРё Р°РєС‚РѕРІ&#13;&#10;Рѕ СЂР°СЃС‚РѕСЂР¶РµРЅРёРё Р±СЂР°РєР° Р·Р° РїРµСЂРёРѕРґ [strPeriod]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Height="18" Left="0" ParentFont="False" Top="227" Width="694.800448737598" OnBeforePrint="MasterData1OnBeforePrint" Columns="1" ColumnWidth="120" ColumnGap="20" DataSet="Query1" DataSetName="Query1" RowCount="0">
      <TfrxMemoView Name="Memo1" Left="9" Top="0" Width="417" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="10" ParentFont="False" VAlign="vaCenter" Text="[Query1.&#34;NAME&#34;]"/>
      <TfrxMemoView Name="Memo2" Left="426" Top="0" Width="109" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[Query1.&#34;KOLVO&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="MasterHeader1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Height="20" Left="0" ParentFont="False" Top="165" Width="694.800448737598">
      <TfrxMemoView Name="Memo5" Left="426" Top="0" Width="109" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РєРѕР»РёС‡РµСЃС‚РІРѕ"/>
      <TfrxMemoView Name="Memo7" Left="9" Top="0" Width="417" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text=""/>
    </TfrxHeader>
    <TfrxReportSummary Name="ReportSummary1" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" Height="19" Left="0" ParentFont="False" Top="303" Width="694.800448737598"/>
  </TfrxReportPage>
</TfrxReport>
