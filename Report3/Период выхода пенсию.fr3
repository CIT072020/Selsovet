<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Ïî óìîë÷àíèþ" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40375.6190210764" ReportOptions.Description.Text="" ReportOptions.LastChange="43122.5965536343" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  strDate, s:String;&#13;&#10;  n:INteger;&#13;&#10;    &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  if GetLastValue('PENS_DATE1','S')='' &#13;&#10;    then DateEdit1.Date:=Now    &#13;&#10;    else DateEdit1.Date:=GetLastValue('PENS_DATE1','D');  &#13;&#10;  if GetLastValue('PENS_DATE2','S')='' &#13;&#10;    then DateEdit2.Date:=Now    &#13;&#10;    else DateEdit2.Date:=GetLastValue('PENS_DATE2','D');  &#13;&#10;  if GetLastValue('SORT_FIO','S')='1' then begin&#13;&#10;    rbFIO.Checked:=true;&#13;&#10;  end else begin                                    &#13;&#10;    rbAdres.Checked:=true;&#13;&#10;  end;          &#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  SetLastValue('PENS_DATE1',DateEdit1.Date, 'D');        &#13;&#10;  SetLastValue('PENS_DATE2',DateEdit2.Date, 'D');&#13;&#10;  if rbFIO.Checked then begin&#13;&#10;    SetLastValue('SORT_FIO', '1', 'S');&#13;&#10;  end else begin&#13;&#10;    SetLastValue('SORT_FIO', '0', 'S');&#13;&#10;  end;            &#13;&#10;  strDate:='ñ '+DatePropis(DateEdit1.Date,3)+' ïî  '+DatePropis(DateEdit2.Date,3);&#13;&#10;  Query.SQL.Text := Replace(Query.SQL.Text, '''2017-01-01''', DateToSQL(DateEdit1.Date-1));        &#13;&#10;  Query.SQL.Text := Replace(Query.SQL.Text, '''2018-01-01''', DateToSQL(DateEdit2.Date));&#13;&#10;  n:=Pos('order by ', Query.SQL.Text);&#13;&#10;  if rbFIO.checked then begin&#13;&#10;    Query.SQL.Text := Copy(Query.SQL.Text,1, n-1)+' order by n.familia, n.name, n.otch';                           &#13;&#10;  end else begin&#13;&#10;    Query.SQL.Text := Copy(Query.SQL.Text,1, n-1)+' order by s.name,u.name,a.dom1,a.dom2,a.kv';                           &#13;&#10;  end;            &#13;&#10;//  showmessage(Query.SQL.Text);                                &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403C80103546F7003480108446174617365747301010C2400000020446174615365743D2251756572792220446174615365744E616D653D225175657279220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query" UserName="Query" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select s.name, u.name name_ul, a.dom, l.nomer, getFIO(n.familia, n.name, n.otch) FIO, pol, dater, n.adres_id &#13;&#10;from íàñåëåíèå n &#13;&#10;  left join ËèöåâûåÑ÷åòà l on n.lic_id=l.id and n.date_fiks=l.date_fiks&#13;&#10;  left join áàçàÄîìîâ a on n.adres_id=a.id and n.date_fiks=a.date_fiks&#13;&#10;  left join ÑïðÍàñÏóíêòîâ s on s.id=a.punkt &#13;&#10;  left join ÑïðÓëèö u on u.id=a.ul &#13;&#10;  where Trud('2017-01-01', n.dater, n.pol)=1 and Trud('2018-01-01', n.dater, n.pol)=2 &#13;&#10;        and n.date_fiks='1899-12-30' and dates is null and propis=true&#13;&#10;order by s.name,u.name,a.dom1,a.dom2,a.kv" SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C656674026D0470546F70027D0A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" Caption="Ïàðàìåòðû" Height="216" ClientHeight="178" Left="490" Top="184" Width="320" ClientWidth="304" OnActivate="DialogPage1OnActivate">
    <TfrxDateEditControl Name="DateEdit1" Left="135" Top="20" Width="145" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="43122.4453418171" Time="43122.4453418171" WeekNumbers="False"/>
    <TfrxDateEditControl Name="DateEdit2" Left="135" Top="51" Width="145" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="43122.4454134028" Time="43122.4454134028" WeekNumbers="False"/>
    <TfrxButtonControl Name="Button1" Left="113" Top="138" Width="75" Height="25" ShowHint="True" Caption="Âûïîëíèòü" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="205" Top="138" Width="75" Height="25" ShowHint="True" Caption="Îòêàç" ModalResult="2"/>
    <TfrxLabelControl Name="Label1" Left="19" Top="22.5" Width="95" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Íà÷àëüíàÿ äàòà" Color="-16777201"/>
    <TfrxLabelControl Name="Label2" Left="19" Top="53.5" Width="87" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Êîíå÷íàÿ äàòà" Color="-16777201"/>
    <TfrxRadioButtonControl Name="rbAdres" Left="19" Top="105" Width="227" Height="17" ShowHint="True" Caption="Ñîðòèðîâàòü ïî àäðåñó" Checked="True" Color="-16777201"/>
    <TfrxRadioButtonControl Name="rbFIO" Left="19" Top="83" Width="241" Height="17" ShowHint="True" Caption="Ñîðòèðîâàòü ïî ÔÈÎ" TabStop="False" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" Orientation="poLandscape" PaperWidth="297" PaperHeight="210" PaperSize="9" LeftMargin="15.875" RightMargin="7.9375" TopMargin="7.9375" BottomMargin="7.9375" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnAfterPrint="Page1OnAfterPrint" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Height="61" Left="0" Top="16" Width="1032.520351875">
      <TfrxMemoView Name="Memo2" Left="1" Top="0" Width="1040" Height="61" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaBottom" Text="Ð¡Ð¿Ð¸ÑÐ¾Ðº Ð²Ñ‹ÑˆÐµÐ´ÑˆÐ¸Ñ… Ð½Ð° Ð¿ÐµÐ½ÑÐ¸ÑŽ Ð¿Ð¾ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ñƒ Ð·Ð° Ð¿ÐµÑ€Ð¸Ð¾Ð´ [strDate]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="20" Left="0" Top="200" Width="1032.520351875" ColumnWidth="0" ColumnGap="0" DataSet="Query" DataSetName="Query" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Queryadres_id" ShiftMode="smDontShift" Left="486" Top="0" Width="427" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" Text="[AdresFromId(&#60;Query.&#34;adres_id&#34;&#62;, false)]"/>
      <TfrxMemoView Name="Memo1" ShiftMode="smDontShift" Left="59" Top="0" Width="284" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" Text="[&#60;Query.&#34;FIO&#34;&#62;]"/>
      <TfrxMemoView Name="Memo10" ShiftMode="smDontShift" Left="913" Top="0" Width="94" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[&#60;Query.&#34;NOMER&#34;&#62;]"/>
      <TfrxMemoView Name="Memo8" ShiftMode="smDontShift" Left="343" Top="0" Width="103" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[DatePropis(&#60;Query.&#34;DATER&#34;&#62;,3)]"/>
      <TfrxMemoView Name="Memo9" ShiftMode="smDontShift" Left="446" Top="0" Width="40" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[&#60;Query.&#34;POL&#34;&#62;]"/>
      <TfrxMemoView Name="Memo12" ShiftMode="smDontShift" Left="0" Top="0" Width="59" Height="20" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" GapY="2" HAlign="haRight" ParentFont="False" Text="[Line#]"/>
    </TfrxMasterData>
    <TfrxPageHeader Name="PageHeader1" Height="44" Left="0" Top="96" Width="1032.520351875">
      <TfrxMemoView Name="Memo3" Left="59" Top="0" Width="284" Height="44" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¤Ð°Ð¼Ð¸Ð»Ð¸Ñ, Ð˜Ð¼Ñ, ÐžÑ‚Ñ‡ÐµÑÑ‚Ð²Ð¾"/>
      <TfrxMemoView Name="Memo4" Left="486" Top="0" Width="427" Height="44" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ´Ñ€ÐµÑ"/>
      <TfrxMemoView Name="Memo5" Left="446" Top="0" Width="40" Height="44" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐŸÐ¾Ð»"/>
      <TfrxMemoView Name="Memo6" Left="343" Top="0" Width="103" Height="44" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð”Ð°Ñ‚Ð° Ñ€Ð¾Ð¶Ð´ÐµÐ½Ð¸Ñ"/>
      <TfrxMemoView Name="Memo7" Left="913" Top="0" Width="94" Height="44" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„– Ð»Ð¸Ñ†ÐµÐ²Ð¾Ð³Ð¾&#13;&#10;ÑÑ‡ÐµÑ‚Ð°"/>
      <TfrxMemoView Name="Memo11" Left="0" Top="0" Width="59" Height="44" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„–"/>
    </TfrxPageHeader>
  </TfrxReportPage>
</TfrxReport>
