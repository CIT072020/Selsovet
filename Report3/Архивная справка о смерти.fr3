<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="38148.420029456" ReportOptions.Description.Text="" ReportOptions.Name="Архивная справка о смерти" ReportOptions.LastChange="42331.7116518866" ReportOptions.VersionMajor="1" ReportOptions.VersionMinor="1" ReportOptions.VersionRelease="1" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  sArx,ss,s,sIzm,strVozr,strMesto,strNorm1,strBold1,strNorm2:String;&#13;&#10;  n:Integer;&#13;&#10;    &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page1, Engine do&#13;&#10;  begin&#13;&#10;  sArx:='';&#13;&#10;  if Parameters('ARXIV')='1' then begin&#13;&#10;    sArx:=getResource('ARX1',0)+'  ';  //   strRes.ini&#13;&#10;  end;&#13;&#10;  &#13;&#10;  ss:='';&#13;&#10;  strMesto := ss+'Место смерти: ' + GetAdresAkt2('fmZapisSmert.Dokument', ';+SM_OBL,SM_B_OBL;SM_RAION;SM_GOROD,SM_B_GOROD;',3)+'.';&#13;&#10;//  strMesto := GetPadeg(strMesto,'П');&#13;&#10;  strNorm1 := '   В документах архива '+ GetPadeg(Parameters('NAME'),'Р');&#13;&#10;  strNorm1 := strNorm1 + ' имеется на хранении запись акта о смерти № '+Trim(Str(&#60;CurDok.&#34;NOMER&#34;&#62;));&#13;&#10;  strNorm1 := strNorm1 + ', совершенная '+ DatePropis(&#60;CurDok.&#34;DATEZ&#34;&#62;,0) + ' года в ';&#13;&#10;  strNorm1 := strNorm1 + SprNameOrg(&#60;CurDok.&#34;ID_ZAGS&#34;&#62;,'','П')+' на ';&#13;&#10;  strNorm1 := strNorm1 + GetPadegFIO3(&#60;CurDok.&#34;Familia&#34;&#62;,&#60;CurDok.&#34;Name&#34;&#62;,&#60;CurDok.&#34;Otch&#34;&#62;,&#60;CurDok.&#34;POL&#34;&#62;,'В');&#13;&#10;//  showmessage(strnorm1);                            &#13;&#10;  if &#60;CurDok.&#34;POL&#34;&#62;='М'&#13;&#10;    then  strNorm1 := strNorm1 +', '+LowerCase(ValueSpr('sprNac-&#62;ID',&#60;CurDok.&#34;NATION&#34;&#62;,'Name_M'))&#13;&#10;    else  strNorm1 := strNorm1 + ', '+LowerCase(ValueSpr('sprNac-&#62;ID',&#60;CurDok.&#34;NATION&#34;&#62;,'Name_G'));&#13;&#10;&#13;&#10;  if &#60;CurDok.&#34;ONLYGOD&#34;&#62;=0 then begin&#13;&#10;    if &#60;CurDok.&#34;POL&#34;&#62;='М'&#13;&#10;      then  strNorm1 := strNorm1 + ', умершего '+ DatePropis(&#60;CurDok.&#34;DATES&#34;&#62;,5)&#13;&#10;      else  strNorm1 := strNorm1 + ', умершую ' + DatePropis(&#60;CurDok.&#34;DATES&#34;&#62;,5);&#13;&#10;  end else begin&#13;&#10;    if &#60;CurDok.&#34;POL&#34;&#62;='М'&#13;&#10;      then  strNorm1 := strNorm1 + ', умершего: '+ DatePropisEx(&#60;CurDok.&#34;DATES&#34;&#62;,5,&#60;CurDok.&#34;ONLYGOD&#34;&#62;)&#13;&#10;      else  strNorm1 := strNorm1 + ', умершую: ' + DatePropisEx(&#60;CurDok.&#34;DATES&#34;&#62;,5,&#60;CurDok.&#34;ONLYGOD&#34;&#62;);&#13;&#10;  end;&#13;&#10;  if DateIsEmpty(&#60;CurDok.&#34;DATES&#34;&#62;) or DateIsEmpty(&#60;CurDok.&#34;DateR&#34;&#62;) then begin&#13;&#10;    if &#60;CurDok.&#34;TEXT_VOZR&#34;&#62;&#60;&#62;'' then begin&#13;&#10;      n:=Pos('/',&#60;CurDok.&#34;TEXT_VOZR&#34;&#62;);&#13;&#10;      if n=0&#13;&#10;        then strVozr:=' , '+&#60;CurDok.&#34;TEXT_VOZR&#34;&#62;&#13;&#10;        else strVozr:=' , '+Copy(&#60;CurDok.&#34;TEXT_VOZR&#34;&#62;,1,n-1);&#13;&#10;    end else begin&#13;&#10;      strVozr:='';&#13;&#10;    end;&#13;&#10;  end else begin&#13;&#10;    if SubDateYear(&#60;CurDok.&#34;DATES&#34;&#62;,&#60;CurDok.&#34;DateR&#34;&#62;)&#60;1 then begin&#13;&#10;      if &#60;CurDok.&#34;DATES&#34;&#62;=&#60;CurDok.&#34;DateR&#34;&#62; then begin&#13;&#10;        strVozr:=', в возрасте менее суток';&#13;&#10;      end else begin&#13;&#10;        strVozr:=', в возрасте '+SubDatePropis(&#60;CurDok.&#34;DATES&#34;&#62;,&#60;CurDok.&#34;DateR&#34;&#62;,0);&#13;&#10;      end;                  &#13;&#10;    end else begin&#13;&#10;      strVozr:=', в возрасте '+GetVozrast(GetCountYear(&#60;CurDok.&#34;DATES&#34;&#62;,&#60;CurDok.&#34;DateR&#34;&#62;));  &#13;&#10;    end;&#13;&#10;  end;&#13;&#10;  strNorm1 := strNorm1 + strVozr+'.';&#13;&#10;&#13;&#10;  strNorm1 := strNorm1 + CRLF + '      '+strMesto + CRLF;&#13;&#10;&#13;&#10;  if &#60;CurDok.&#34;IZMEN&#34;&#62;=''&#13;&#10;    then sIzm:=getResource('SPR_SMERT_IZM',0)&#13;&#10;    else sIzm:=&#60;CurDok.&#34;IZMEN&#34;&#62;;&#13;&#10;&#13;&#10;  strNorm1 := strNorm1 + '      '+sIzm+CRLF;        &#13;&#10;  strNorm1 := strNorm1 + '      '+'Справка действительна в течение '+RunFuncScriptEx('getSrokDv',[1])+'.';&#13;&#10;  strBold1:='';&#13;&#10;  strNorm2:='';&#13;&#10;  end;    &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403A80203546F7003000108446174617365747301010C4600000020446174615365743D22666D5A61706973536D6572742E6672785F666D5A61706973536D6572745F446F6B756D656E742220446174615365744E616D653D22437572446F6B2200010C4C00000020446174615365743D22666D5A61706973536D6572742E6672785F666D5A61706973536D6572745F53766964506F76746F722220446174615365744E616D653D2253766964506F76746F72220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000"/>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="26.5615208333333" RightMargin="11.96975" TopMargin="13.3852708333333" BottomMargin="10.7394375" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Height="205" Left="0" Top="16" Width="648.071205947292" Stretched="True">
      <TfrxMemoView Name="Memo7" ShiftMode="smDontShift" Left="254" Top="143" Width="388" Height="60" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="[CurDok.&#34;ARX_ADRESAT&#34;]"/>
      <TfrxMemoView Name="Memo4" ShiftMode="smDontShift" Left="0" Top="2" Width="248" Height="194" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="[Parameters('SHTAMP')]"/>
      <TfrxMemoView Name="Memo2" ShiftMode="smDontShift" Left="467" Top="0" Width="176" Height="136" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text="[getPril(-1,'POST_ZAGS_SPR',9)]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="130" Left="0" Top="280" Width="648.071205947292" Child="Child1" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="fmZapisSmert.frx_fmZapisSmert_Dokument" DataSetName="CurDok" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Memo8" ShiftMode="smDontShift" Left="0" Top="7" Width="642" Height="67" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="[sArx]РЎРџР РђР’РљРђ,&#13;&#10;СЃРѕРґРµСЂР¶Р°С‰Р°СЏ СЃРІРµРґРµРЅРёСЏ РёР· Р·Р°РїРёСЃРё Р°РєС‚Р° Рѕ СЃРјРµСЂС‚Рё&#13;&#10;[DatePropis(&#60;CurDok.&#34;ARX_DATE&#34;&#62;,0)] Рі.   в„–  [&#60;CurDok.&#34;ARX_NOMER&#34;&#62;]"/>
      <TfrxMemoView Name="Memo1" ShiftMode="smDontShift" Left="0" Top="81" Width="642" Height="47" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" HAlign="haBlock" ParentFont="False" Text="[strNorm1]"/>
    </TfrxMasterData>
    <TfrxChild Name="Child1" Height="40" Left="0" Top="432" Width="648.071205947292" Stretched="True">
      <TfrxMemoView Name="Memo33" ShiftMode="smDontShift" Left="0" Top="7" Width="327" Height="27" ShowHint="False" StretchMode="smActualHeight" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaBottom" Text="[RunFuncScript('Zags_Sprav_Dolg')]"/>
      <TfrxMemoView Name="Memo34" ShiftMode="smDontShift" Left="371" Top="7" Width="271" Height="24" ShowHint="False" StretchMode="smActualHeight" AutoWidth="True" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaBottom" Text="[RunFuncScript('Zags_Sprav_FIO')]"/>
    </TfrxChild>
    <TfrxPageFooter Name="PageFooter1" Height="20" Left="0" Top="532" Width="648.071205947292">
      <TfrxMemoView Name="Memo3" Left="8.66666667" Top="0" Width="290.66666667" Height="16" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-12" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="[RunFuncScriptEx('CreateKolonN',[1])]"/>
    </TfrxPageFooter>
  </TfrxReportPage>
</TfrxReport>
