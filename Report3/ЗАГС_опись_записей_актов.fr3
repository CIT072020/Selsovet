<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="D:\_ЗАГС\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.Author="ЦИТ Белстата" ReportOptions.CreateDate="38251.4373884143" ReportOptions.Description.Text="" ReportOptions.Name="Опись записей актов" ReportOptions.LastChange="43531.4037323264" ReportOptions.VersionMajor="1" ReportOptions.VersionMinor="1" ReportOptions.VersionRelease="1" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  sName,sWhere,strType,strTypeName,sYear,sDate1,sDate2,s:String;&#13;&#10;  n,m,i,nObj,nTypeAkt,nMax,nIDZags:Integer;&#13;&#10;  nL,nW:Extended;&#13;&#10;  D1,D2:TDateTime;&#13;&#10;    &#13;&#10;//-------------------------------------------------------------------&#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DialogPage1, Engine do&#13;&#10;  begin&#13;&#10;  nIDZags:=ParamAsInteger('ID');&#13;&#10;  &#13;&#10;  nObj:=PropCurGurnal('TYPEEDITOBJ',0);&#13;&#10;  if nObj=0 then begin                                                  &#13;&#10;    s:=trim(GetLastValue('ALFAVIT_TYPE_AKT2','S'));&#13;&#10;    if s='' then edType.ItemIndex:=0  else edType.KeyIndex:=s;&#13;&#10;    if edType.ItemIndex=-1 then edType.ItemIndex:=0;&#13;&#10;    edType.Enabled:=true;                                                  &#13;&#10;  end else begin&#13;&#10;    edType.KeyIndex:=IntToStr(nObj);&#13;&#10;    if edType.ItemIndex=-1 then edType.ItemIndex:=0;&#13;&#10;    edType.Enabled:=false;                                                  &#13;&#10;  end;            &#13;&#10;  edTypeOnChange(nil);                &#13;&#10;  s:=trim(GetLastValue('ZAGS_GOD','S'));&#13;&#10;  if s='' then edGod1.Text:=Str(YearOf(DATE)) else edGod1.Text:=s;&#13;&#10;&#13;&#10;  n:=GetLastValue('ZAGS_MONTH1','N');&#13;&#10;  if (n&#62;=1) and (n&#60;=12) then edMonth1.ItemIndex:=n-1 else edMonth1.ItemIndex:=0;&#13;&#10;  n:=GetLastValue('ZAGS_MONTH2','N');&#13;&#10;  if (n&#62;=1) and (n&#60;=12) then edMonth2.ItemIndex:=n-1 else edMonth2.ItemIndex:=0;&#13;&#10;  &#13;&#10;//  cbOrgan.Checked:=GetLastValue('ALFAVIT_cbALLORGAN','L');&#13;&#10;//  cbOrder.Checked:=GetLastValue('ALFAVIT_cbORDER','L');&#13;&#10;    &#13;&#10;//  edOrgan.KeyValue:=nIDZags;&#13;&#10;//  edOrgan.Enabled:=not cbAllOrgan.Checked;&#13;&#10;          &#13;&#10;//  if IdProg()='SELSOVET' then begin&#13;&#10;//    cbNameOrg.Visible:=false;&#13;&#10;//  end else begin&#13;&#10;//    cbNameOrg.Visible:=true;&#13;&#10;//  end;&#13;&#10;  &#13;&#10;//  par1 := FormatDateTime('yyyy-mm-dd',DATE);&#13;&#10;//  messageBox(par1,'');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;//-------------------------------------------------------------------                                                                                                                                              &#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Button1, Engine do&#13;&#10;  begin&#13;&#10;&#13;&#10;  strTypeName:='К';&#13;&#10;&#13;&#10;  sYear := edGod1.text;&#13;&#10;  D1:=StartOfTheMonth(STOD(sYear+PADL(edMonth1.KeyIndex,2,'0')+'01','C'));&#13;&#10;  sDate1:=DatePropis(D1,3);&#13;&#10;  D2:=EndOfTheMonth(STOD(sYear+PADL(edMonth2.KeyIndex,2,'0')+'01','C'));&#13;&#10;  sDate2:=DatePropis(D2,3);&#13;&#10;&#13;&#10;  nTypeAkt:=StrToInt(edType.KeyIndex);                        &#13;&#10;  strType:=ValueKey('KEY_TYPEZAGS_FULL',nTypeAkt);&#13;&#10;&#13;&#10;//  showmessage(inttostr(nTypeAkt)+'   '+strType);&#13;&#10;      &#13;&#10;  sName:=RunFuncScriptEx('GetNameTableFromTypeObj', [nTypeAkt]);&#13;&#10;  Query.SQL.Text:=Replace(Query.SQL.Text,'АктыРождений', sName);                         &#13;&#10;  Query.SQL.Text:=Replace(Query.SQL.Text,'999', IntToStr(nIDZags));                         &#13;&#10;  Query.SQL.Text:=Replace(Query.SQL.Text,'''2000-01-01''', DateToSQL(d1));                         &#13;&#10;  Query.SQL.Text:=Replace(Query.SQL.Text,'''2020-12-31''', DateToSQL(d2));                         &#13;&#10;&#13;&#10;  SetLastValue('ALFAVIT_TYPE_AKT2',edType.KeyIndex,'S');&#13;&#10;  SetLastValue('ZAGS_GOD',sYear,'S');&#13;&#10;  SetLastValue('ZAGS_MONTH1',edMonth1.KeyIndex, 'S');&#13;&#10;  SetLastValue('ZAGS_MONTH2',edMonth2.KeyIndex, 'S');&#13;&#10;&#13;&#10;  if (nTypeAkt=_TypeObj_ZRogd) or (nTypeAkt=_TypeObj_ZSmert) or (nTypeAkt=_TypeObj_ZBrak) then begin&#13;&#10;    Query.SQL.Text:=Replace(Query.SQL.Text, '1=1', '(vosstan is null or vosstan=false)');                         &#13;&#10;  end;            &#13;&#10;  &#13;&#10;      //  ShowMessage(Query.SQL.text);&#13;&#10;  MemoWrite('report.sql',Query.SQL.Text);                        &#13;&#10;      &#13;&#10;//  sYear1  := edGod.KeyItems[edGod.ItemIndex];&#13;&#10;//  sMonth := edMonth.KeyItems[edMonth.ItemIndex];&#13;&#10;//  strNameMonth := UpperCase(edMonth.Items[edMonth.ItemIndex]);&#13;&#10;//  strNameDate := LowerCase(strNameMonth) + ' ' + sYear;&#13;&#10;  end;          &#13;&#10;end;&#13;&#10;&#13;&#10;procedure edTypeOnChange(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;{    &#13;&#10;  n:=StrToInt(edType.KeyIndex);&#13;&#10;  case n of&#13;&#10;    _TypeObj_ZBrak: begin&#13;&#10;                      edPropAkt.ItemIndex:=1;                                      &#13;&#10;                      edPropAkt.Enabled:=true;                                      &#13;&#10;                    end;&#13;&#10;    _TypeObj_ZRast: begin&#13;&#10;                      edPropAkt.ItemIndex:=0;                                      &#13;&#10;                      edPropAkt.Enabled:=false;                                      &#13;&#10;                    end;&#13;&#10;    _TypeObj_ZRogd,_TypeObj_ZSmert: begin&#13;&#10;                      edPropAkt.ItemIndex:=1;                                      &#13;&#10;                      edPropAkt.Enabled:=true;                                      &#13;&#10;                    end;&#13;&#10;    _TypeObj_ZUstOtc,_TypeObj_ZUstMat,_TypeObj_ZChName,_TypeObj_ZAdopt: begin&#13;&#10;                      edPropAkt.ItemIndex:=0;                                      &#13;&#10;                      edPropAkt.Enabled:=false;                                      &#13;&#10;                    end;&#13;&#10;  end;&#13;&#10;}      &#13;&#10;end;&#13;&#10;&#13;&#10;procedure cbNameOrgOnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" OnReportPrint="frxReportOnReportPrint" PropData="044C65667403A80203546F7003000108446174617365747301010C2400000020446174615365743D2251756572792220446174615365744E616D653D225175657279220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query" UserName="Query" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select IIF(id_zags=999,0,1) TYPEZAGS, s.SOATO, IFNULL(s.KNAME,s.NAME) NAME,  ID_ZAGS, MINN, MAXN, KOLVO &#13;&#10;from (&#13;&#10;  select id_zags, min(nomer) minn, max(nomer) maxn, count(*) kolvo &#13;&#10;  from АктыРождений b&#13;&#10;  where datez&#62;='2000-01-01' and datez&#60;='2020-12-31' and 1=1 &#13;&#10;  group  by 1) aaa&#13;&#10;left join SprNames s on s.id=aaa.id_zags &#13;&#10;order by typezags, name" SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C6566740392000470546F7002500A506172616D65746572730100"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Опись записей актов" Color="-2147483633" Height="214" ClientHeight="176" Left="409" Top="162" Width="442" ClientWidth="426" OnShow="DialogPage1OnShow">
    <TfrxMComboBoxControl Name="edType" Left="132" Top="6" Width="267" Height="29" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Items.Text="о заключении брака&#13;&#10;о расторжении брака&#13;&#10;о рождении&#13;&#10;о смерти&#13;&#10;об установлении отцовства&#13;&#10;об усыновлении&#13;&#10;о перемене имени&#13;&#10;об установлении материнства" KeyItems.Text="5&#13;&#10;11&#13;&#10;6&#13;&#10;7&#13;&#10;8&#13;&#10;12&#13;&#10;13&#13;&#10;18" Style="csDropDownList" Text="о заключении брака" ItemIndex="0" ItemCount="8" NameOpis="KEY_TYPEZAGS_FULL" KeyIndex="5" OnChange="edTypeOnChange"/>
    <TfrxEditControl Name="edGod1" Left="132" Top="38" Width="59" Height="29" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-2147483643" MaxLength="0" PasswordChar="0"/>
    <TfrxButtonControl Name="Button1" Left="224" Top="138" Width="91" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Выполнить" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxLabelControl Name="Label1" Left="13" Top="44.5" Width="21" Height="16" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Год" Color="-2147483633"/>
    <TfrxButtonControl Name="Button2" Left="333" Top="138" Width="75" Height="25" Font.Charset="1" Font.Color="-2147483640" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Cancel="True" Caption="Отказ" ModalResult="2"/>
    <TfrxLabelControl Name="Label3" Left="13" Top="12.5" Width="79" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Записи актов" Color="-2147483633"/>
    <TfrxMDBLookupComboBox Name="edOrgan" Left="213" Top="105" Width="65" Height="25" ShowHint="True" Visible="False" ListField="NAME" KeyField="ID" NameOpisEdit="LOOKUP_SPRNAMES"/>
    <TfrxMComboBoxControl Name="edPropAkt" Left="6" Top="110" Width="139" Height="25" ShowHint="True" Visible="False" Color="-16777211" Items.Text="Все записи&#13;&#10;Первичные записи&#13;&#10;Восстановленные" KeyItems.Text="1&#13;&#10;2&#13;&#10;3" Style="csDropDownList" Text="Первичные записи" ItemIndex="1" ItemCount="3" NameOpis="KEY_PROP_AKT" KeyIndex="2"/>
    <TfrxMComboBoxControl Name="edMonth1" Left="132" Top="72" Width="97" Height="29" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Items.Text="Январь&#13;&#10;Февраль&#13;&#10;Март&#13;&#10;Апрель&#13;&#10;Май&#13;&#10;Июнь&#13;&#10;Июль&#13;&#10;Август&#13;&#10;Сентябрь&#13;&#10;Октябрь&#13;&#10;Ноябрь&#13;&#10;Декабрь" KeyItems.Text="1&#13;&#10;2&#13;&#10;3&#13;&#10;4&#13;&#10;5&#13;&#10;6&#13;&#10;7&#13;&#10;8&#13;&#10;9&#13;&#10;10&#13;&#10;11&#13;&#10;12" Style="csDropDownList" Text="Январь" ItemIndex="0" ItemCount="12" NameOpis="KEY_MONTH" KeyIndex="1"/>
    <TfrxLabelControl Name="Label2" Left="13" Top="78.5" Width="39" Height="16" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Месяц" Color="-2147483633"/>
    <TfrxLabelControl Name="Label4" Left="106" Top="78.5" Width="7" Height="16" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="с" Color="-2147483633"/>
    <TfrxLabelControl Name="Label5" Left="256" Top="78.5" Width="14" Height="16" Font.Charset="1" Font.Color="-2147483640" Font.Height="-13" Font.Name="arial" Font.Style="0" ParentFont="False" ShowHint="True" Caption="по" Color="-2147483633"/>
    <TfrxMComboBoxControl Name="edMonth2" Left="302" Top="72" Width="97" Height="29" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Items.Text="Январь&#13;&#10;Февраль&#13;&#10;Март&#13;&#10;Апрель&#13;&#10;Май&#13;&#10;Июнь&#13;&#10;Июль&#13;&#10;Август&#13;&#10;Сентябрь&#13;&#10;Октябрь&#13;&#10;Ноябрь&#13;&#10;Декабрь" KeyItems.Text="1&#13;&#10;2&#13;&#10;3&#13;&#10;4&#13;&#10;5&#13;&#10;6&#13;&#10;7&#13;&#10;8&#13;&#10;9&#13;&#10;10&#13;&#10;11&#13;&#10;12" Style="csDropDownList" Text="Январь" ItemIndex="0" ItemCount="12" NameOpis="KEY_MONTH" KeyIndex="1"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="18.5208333333333" RightMargin="5.29166666666667" TopMargin="10.00125" BottomMargin="10.00125" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="">
    <TfrxReportTitle Name="ReportTitle2" Height="60" Left="0" Top="16" Width="703.701241875">
      <TfrxMemoView Name="Memo5" Left="0" Top="0" Width="704" Height="60" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" LineSpacing="0" ParentFont="False" Text="РћРїРёСЃСЊ Р·Р°СЂРµРіРёСЃС‚СЂРёСЂРѕРІР°РЅРЅС‹С… Р·Р°РїРёСЃРµР№ Р°РєС‚РѕРІ [strType]&#13;&#10;Р·Р° РїРµСЂРёРѕРґ СЃ [sDate1]Рі. РїРѕ [sDate2]Рі."/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData2" Height="22" Left="0" Top="196" Width="703.701241875" ColumnWidth="250" ColumnGap="0" DataSet="Query" DataSetName="Query" RowCount="0">
      <TfrxMemoView Name="Memo6" Left="426" Top="0" Width="169" Height="22" ShowHint="False" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text="[Query.&#34;MINN&#34;]-[Query.&#34;MAXN&#34;]"/>
      <TfrxMemoView Name="Memo8" Left="595" Top="0" Width="109" Height="22" ShowHint="False" DataField="KOLVO" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[Query.&#34;KOLVO&#34;]"/>
      <TfrxMemoView Name="Memo12" Left="0" Top="0" Width="426" Height="22" ShowHint="False" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" Text="[Query.&#34;NAME&#34;]"/>
    </TfrxMasterData>
    <TfrxHeader Name="Header2" Height="40" Left="0" Top="136" Width="703.701241875">
      <TfrxMemoView Name="Memo10" Left="426" Top="0" Width="169" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РЎ РЅРѕРјРµСЂР° РїРѕ РЅРѕРјРµСЂ"/>
      <TfrxMemoView Name="Memo11" Left="595" Top="0" Width="109" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РљРѕР»РёС‡РµСЃС‚РІРѕ"/>
      <TfrxMemoView Name="Memo13" Left="0" Top="0" Width="426" Height="40" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="РћСЂРіР°РЅ СЂРµРіРёСЃС‚СЂР°С†РёРё"/>
    </TfrxHeader>
    <TfrxFooter Name="Footer1" Height="22" Left="0" Top="240" Width="703.701241875">
      <TfrxMemoView Name="Memo1" Left="595" Top="0" Width="109" Height="22" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;Query.&#34;KOLVO&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo2" Left="0" Top="0" Width="426" Height="22" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" GapX="5" ParentFont="False" Text="Р’СЃРµРіРѕ"/>
      <TfrxMemoView Name="Memo3" Left="426" Top="0" Width="169" Height="22" ShowHint="False" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxFooter>
    <TfrxReportSummary Name="ReportSummary1" Height="308" Left="0" Top="320" Width="703.701241875">
      <TfrxMemoView Name="Memo19" Left="0" Top="30" Width="296" Height="88" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaBottom" Text="[RunFuncScript('Zags_Otchet_Dolg')]"/>
      <TfrxMemoView Name="Memo20" Left="436" Top="30" Width="234" Height="88" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" GapX="5" ParentFont="False" VAlign="vaBottom" Text="[RunFuncScript('Zags_Otchet_FIO')]"/>
      <TfrxMemoView Name="Memo21" Left="308" Top="30" Width="128" Height="88" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-17" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="8" ParentFont="False" VAlign="vaCenter" Text=""/>
      <TfrxMemoView Name="Memo118" Left="308" Top="118" Width="128" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="(РїРѕРґРїРёСЃСЊ)"/>
      <TfrxMemoView Name="Memo79" Left="1" Top="1" Width="703" Height="29" ShowHint="False" Font.Charset="1" Font.Color="-16777208" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" Text=""/>
      <TfrxMemoView Name="Memo80" Left="296" Top="30" Width="12" Height="88" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text=""/>
    </TfrxReportSummary>
  </TfrxReportPage>
</TfrxReport>
