<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="Default" PrintOptions.PrintOnSheet="0" ReportOptions.Author="Âàäèì ×óðà" ReportOptions.CreateDate="38251.4373884143" ReportOptions.Description.Text="" ReportOptions.Name="×èñëåííîñòü íàñåëåíèÿ" ReportOptions.LastChange="42818.5029763079" ReportOptions.VersionMajor="1" ReportOptions.VersionMinor="1" ScriptLanguage="PascalScript" ScriptText.Text="Var&#13;&#10;  npp,nCount:Integer;&#13;&#10;  strDate:String;&#13;&#10;    &#13;&#10;procedure DialogPage1OnShow(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with DialogPage1, Engine do&#13;&#10;  begin&#13;&#10;  npp:=1;&#13;&#10;  nCount:=0;&#13;&#10;  strDate := FormatDateTime('yyyy-mm-dd', GetDateFiks());&#13;&#10;//  s := ''''+FormatDateTime('yyyy-mm-dd', DateFiksReal())+'''';&#13;&#10;//  s := DateToStr(DateFiksReal());&#13;&#10;&#13;&#10;  Query1.SQL.text := Replace(Query1.SQL.text, '&#38;VOZRAST&#38;', GetSQLVozrast(DateToSQL(DateFiksReal()),'dater'));&#13;&#10;&#13;&#10;//  messageBox(Query1.SQL,'');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page2OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Page2, Engine do&#13;&#10;  begin&#13;&#10;npp:=0;&#13;&#10;//  s := GetAdres('MAIN');&#13;&#10;//  s := ChoiceKey('KEY_TUL');&#13;&#10;//  if Length(s)&#62;0 then begin&#13;&#10;//    ss:=ValueKey('KEY_TUL',s);&#13;&#10;//    Edit1.text:=s+'/'+ss;&#13;&#10;//  end;&#13;&#10;//  MessageBox(Parameters(' main_select'),'');&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with Button1, Engine do&#13;&#10;  begin&#13;&#10;  if cbPresent.Checked  // äîïîëíèòåëüíî âêëþ÷àòü âðåìåííî îòñóòñòâóþùèõ&#13;&#10;    then  Query1.SQL.text := Replace(Query1.SQL.text, '&#38;PRESENT&#38;', '')&#13;&#10;    else  Query1.SQL.text := Replace(Query1.SQL.text, '&#38;PRESENT&#38;', ' n.present=true and ');&#13;&#10;&#13;&#10;  if not cbNotStat.Checked&#13;&#10;    then Query1.SQL.text := Replace(Query1.SQL.text, '1=1', '(l.not_stat is null or l.not_stat=false)');&#13;&#10;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;procedure GroupFooter1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  with GroupFooter1, Engine do&#13;&#10;  begin&#13;&#10;  npp:=npp+1;&#13;&#10;  end&#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403C80103546F7003480108446174617365747301010C2600000020446174615365743D225175657279312220446174615365744E616D653D22517565727931220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query1" UserName="Query1" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select sss.name, sss.id, aaa.lic_id, aaa.kolvo, aaa.ml_trud, aaa.trud,&#13;&#10;       aaa.st_trud, aaa.nvozr, isnull(aaa.yes_lic_n,0) yes_lic, typepunkt &#13;&#10;from ÑïðÍàñÏóíêòîâ sss &#13;&#10;left join (&#13;&#10;SELECT s.id, n.lic_id LIC_ID ,&#13;&#10;    Count(*) kolvo,&#13;&#10;&#13;&#10;    SUM( CASE WHEN &#13;&#10;           (POL='Ì' and TrudM(curDate(),DATER)=0) or&#13;&#10;           (POL='Æ' and TrudG(curDate(),DATER)=0) THEN 1 ELSE 0 END) ML_TRUD,&#13;&#10;&#13;&#10;    Sum( CASE WHEN &#13;&#10;           (POL='Ì' and TrudM(curDate(),DATER)=1) or&#13;&#10;           (POL='Æ' and TrudG(curDate(),DATER)=1) THEN 1 ELSE 0 END) TRUD,&#13;&#10;&#13;&#10;    Sum( CASE WHEN &#13;&#10;           (POL='Ì' and TrudM(curDate(),DATER)=2) or&#13;&#10;           (POL='Æ' and TrudG(curDate(),DATER)=2) THEN 1 ELSE 0 END) ST_TRUD,&#13;&#10;&#13;&#10;    Sum( CASE WHEN dater is null THEN 1 ELSE 0 END) nvozr,&#13;&#10;    1 yes_lic_n&#13;&#10;  FROM Íàñåëåíèå n&#13;&#10;    LEFT OUTER JOIN ËèöåâûåÑ÷åòà l ON n.date_fiks=l.date_fiks and n.lic_id=l.id&#13;&#10;    LEFT OUTER JOIN ÁàçàÄîìîâ d ON n.date_fiks=d.date_fiks and l.adres_id=d.id&#13;&#10;    LEFT OUTER JOIN ÑïðÍàñÏóíêòîâ s ON s.id=d.punkt&#13;&#10;  WHERE n.date_fiks=:par1 and n.candelete=false and &#38;PRESENT&#38; propis=true and lic_id is not null and lic_id&#62;0 and (s.not_stat is null or s.not_stat=false) and 1=1&#13;&#10;  GROUP BY 1,2&#13;&#10;  ) aaa  ON aaa.id=sss.id&#13;&#10;  &#13;&#10;where sss.not_stat is null or sss.not_stat=false&#13;&#10;order by 1&#13;&#10;  " SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C65667402490470546F70021F0A506172616D657465727301010C3F000000204E616D653D2270617231222044617461547970653D226674537472696E67222045787072657373696F6E3D22262336303B73747264617465262336323B220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Äîïîëíèòåëüíî" Color="-2147483633" Height="159" ClientHeight="121" Left="459" Top="204" Width="319" ClientWidth="303" OnShow="DialogPage1OnShow">
    <TfrxButtonControl Name="Button1" Left="123" Top="86" Width="75" Height="25" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Ïîëó÷èòü" Default="True" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxCheckBoxControl Name="cbPresent" Left="13" Top="6" Width="283" Height="17" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Caption=" Âêëþ÷àòü âðåìåííî îòñóòñòâóþùèõ" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxButtonControl Name="Button2" Left="212" Top="86" Width="75" Height="25" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Cancel="True" Caption="Îòêàç" ModalResult="2"/>
    <TfrxCheckBoxControl Name="cbNotStat" Left="13" Top="29" Width="16" Height="13" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxLabelControl Name="Label1" Left="33" Top="28" Width="261" Height="46" Font.Charset="1" Font.Color="-16777208" Font.Height="-11" Font.Name="MS Sans Serif" Font.Style="0" ParentFont="False" ShowHint="True" AutoSize="False" Caption="Âêëþ÷àòü ëèöåâûå ñ÷åòà îòìå÷åííûå, êàê èñêëþ÷åííûå äëÿ ôîðì ñòàòèñòèêè" Color="-16777201" WordWrap="True"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page2" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="14" RightMargin="5" TopMargin="15" BottomMargin="10" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnBeforePrint="Page2OnBeforePrint">
    <TfrxMasterData Name="MasterData1" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Height="20" Left="0" ParentFont="False" Top="260" Visible="False" Width="721.89023" Columns="1" ColumnWidth="200" ColumnGap="20" DataSet="Query1" DataSetName="Query1" RowCount="0">
      <TfrxMemoView Name="Memo2" Left="273" Top="0" Width="60" Height="20" Visible="False" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="[&#60;Query1.&#34;KOLVO&#34;&#62;]"/>
    </TfrxMasterData>
    <TfrxGroupFooter Name="GroupFooter1" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Height="19" Left="0" ParentFont="False" Top="300" Width="721.89023" OnBeforePrint="GroupFooter1OnBeforePrint" Stretched="True">
      <TfrxMemoView Name="Memo6" Left="37" Top="0" Width="231" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="[ValueSpr('typepunkt-&#62;ID',&#60;Query1.&#34;TYPEPUNKT&#34;&#62;,'NAME')] [&#60;Query1.&#34;NAME&#34;&#62;]"/>
      <TfrxMemoView Name="Memo8" Left="411" Top="0" Width="71" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;ML_TRUD&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo9" Left="489" Top="0" Width="69" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;TRUD&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo10" Left="562" Top="0" Width="73" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;ST_TRUD&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo11" Left="342" Top="0" Width="61" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;KOLVO&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo1" Left="273" Top="0" Width="63" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;yes_lic&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo7" Left="5" Top="1" Width="31" Height="17" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[npp]"/>
      <TfrxMemoView Name="Memo27" Left="649" Top="0" Width="59" Height="18" ShowHint="False" StretchMode="smMaxHeight" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;NVOZR&#34;&#62;,0,1)]"/>
    </TfrxGroupFooter>
    <TfrxGroupHeader Name="GroupHeader1" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Height="20" Left="0" ParentFont="False" Top="220" Visible="False" Width="721.89023" Condition="&#60;Query1.&#34;NAME&#34;&#62;+IntToStr(&#60;Query1.&#34;ID&#34;&#62;)"/>
    <TfrxReportSummary Name="ReportSummary1" Font.Charset="1" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Height="27" Left="0" ParentFont="False" Top="340" Width="721.89023">
      <TfrxMemoView Name="Memo18" Left="36" Top="7" Width="231" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" VAlign="vaCenter" Text="Ð˜Ð¢ÐžÐ“Ðž"/>
      <TfrxMemoView Name="Memo19" Left="411" Top="7" Width="71" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;ML_TRUD&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo20" Left="489" Top="7" Width="69" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;TRUD&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo21" Left="562" Top="7" Width="73" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-13" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;ST_TRUD&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo22" Left="342" Top="7" Width="61" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;KOLVO&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo23" Left="273" Top="7" Width="63" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;yes_lic&#34;&#62;,0,1)]"/>
      <TfrxLineView Name="Line1" Left="5" Top="4" Width="700" Height="0" ShowHint="False" Frame.Typ="4"/>
      <TfrxMemoView Name="Memo28" Left="649" Top="7" Width="59" Height="18" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" HAlign="haRight" ParentFont="False" VAlign="vaCenter" Text="[SUM(&#60;Query1.&#34;NVOZR&#34;&#62;,0,1)]"/>
    </TfrxReportSummary>
    <TfrxPageHeader Name="PageHeader1" Height="184" Left="0" Top="16" Width="721.89023">
      <TfrxMemoView Name="Memo4" Left="9" Top="55" Width="685" Height="17" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="Ð¡Ð²ÐµÐ´ÐµÐ½Ð¸Ñ Ð¾ Ñ‡Ð¸ÑÐ»Ðµ Ñ…Ð¾Ð·ÑÐ¹ÑÑ‚Ð² Ð¸ Ñ‡Ð¸ÑÐ»ÐµÐ½Ð½Ð¾ÑÑ‚Ð¸ Ð½Ð°ÑÐµÐ»ÐµÐ½Ð¸Ñ "/>
      <TfrxMemoView Name="Memo3" Left="5" Top="103" Width="32" Height="80.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="â„–&#13;&#10;Ð¿/Ð¿"/>
      <TfrxMemoView Name="Memo5" Left="37" Top="103" Width="234" Height="80.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÐÐ°Ð¸Ð¼ÐµÐ½Ð¾Ð²Ð°Ð½Ð¸Ðµ ÑÐµÐ»ÑŒÑÐºÐ¾Ð³Ð¾ Ð½Ð°ÑÐµÐ»ÐµÐ½Ð½Ð¾Ð³Ð¾ Ð¿ÑƒÐ½ÐºÑ‚Ð°"/>
      <TfrxMemoView Name="Memo12" Left="271" Top="103" Width="67" Height="80.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð§Ð¸ÑÐ»Ð¾ Ñ…Ð¾Ð·ÑÐ¹ÑÑ‚Ð²"/>
      <TfrxMemoView Name="Memo13" Left="338" Top="103" Width="68.77953" Height="80.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð§Ð¸ÑÐ»ÐµÐ½- Ð½Ð¾ÑÑ‚ÑŒ Ð¿Ð¾ÑÑ‚Ð¾ÑÐ½Ð½Ð¾ Ð¿Ñ€Ð¾Ð¶Ð¸- Ð²Ð°ÑŽÑ‰Ð¸Ñ…"/>
      <TfrxMemoView Name="Memo14" Left="407" Top="103" Width="302.55906" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð² Ñ‚Ð¾Ð¼ Ñ‡Ð¸ÑÐ»Ðµ Ð¿Ð¾ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚Ð°Ð¼"/>
      <TfrxMemoView Name="Memo15" Left="407" Top="123" Width="77.77953" Height="60.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð¼Ð¾Ð»Ð¾Ð¶Ðµ Ñ‚Ñ€ÑƒÐ´Ð¾- ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾Ð³Ð¾"/>
      <TfrxMemoView Name="Memo16" Left="485" Top="123" Width="75" Height="60.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ñ‚Ñ€ÑƒÐ´Ð¾- ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾Ð³Ð¾"/>
      <TfrxMemoView Name="Memo17" Left="560" Top="123" Width="76.77953" Height="60.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="ÑÑ‚Ð°Ñ€ÑˆÐµ Ñ‚Ñ€ÑƒÐ´Ð¾- ÑÐ¿Ð¾ÑÐ¾Ð±Ð½Ð¾Ð³Ð¾"/>
      <TfrxMemoView Name="Memo24" Left="10" Top="4" Width="683" Height="48" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="1" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="[NameOrg()] [Obl_Name('Ð ')]"/>
      <TfrxMemoView Name="Memo25" Left="9" Top="75" Width="687" Height="20" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" HAlign="haCenter" ParentFont="False" Text="Ð½Ð° [DatePropis(DateFiksReal(),0)] Ð³Ð¾Ð´Ð°"/>
      <TfrxMemoView Name="Memo26" Left="637" Top="123" Width="73" Height="60.77953" ShowHint="False" Font.Charset="204" Font.Color="0" Font.Height="-15" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haCenter" ParentFont="False" VAlign="vaCenter" Text="Ð½ÐµÐ¸Ð·- Ð²ÐµÑÑ‚Ð½Ñ‹Ð¹ Ð²Ð¾Ð·Ñ€Ð°ÑÑ‚"/>
    </TfrxPageHeader>
  </TfrxReportPage>
</TfrxReport>
