<?xml version="1.0" encoding="utf-8"?>
<TfrxReport Version="4.12" DotMatrixReport="False" IniFile="E:\Projects\Selsovet7\Work\FastReports.ini" OldStyleProgress="True" PreviewOptions.Buttons="4095" PreviewOptions.Zoom="1" PrintOptions.Printer="По умолчанию" PrintOptions.PrintOnSheet="0" ReportOptions.CreateDate="40375.6190210764" ReportOptions.Description.Text="" ReportOptions.LastChange="43027.4797992477" ScriptLanguage="PascalScript" ScriptText.Text="var&#13;&#10;  s,ss,sName,sDate1,sDate2:String;                                                   &#13;&#10;  &#13;&#10;procedure Page1OnBeforePrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Page1OnAfterPrint(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;end;&#13;&#10;&#13;&#10;procedure Button1OnClick(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;//  if (DateEdit1.Date=0) or (DateEdit2.Date=0) &#13;&#10;//    then begin&#13;&#10;//    showmessage('11111111111');&#13;&#10;//    end;              &#13;&#10;  &#13;&#10;  Query.Close;&#13;&#10;&#13;&#10;  sDate1 := FormatDateTime('yyyy-mm-dd',DateEdit1.Date);&#13;&#10;  sDate2 := FormatDateTime('yyyy-mm-dd',DateEdit2.Date);&#13;&#10;            &#13;&#10;  s:='';&#13;&#10;  sName:='Административные процедуры';                                                            &#13;&#10;  if cbMen.Checked and cbOrg.Checked then begin&#13;&#10;  end else if cbMen.Checked then begin&#13;&#10;    sName:='Административные процедуры для граждан';                                                          &#13;&#10;    s:='adm_proc&#60;10000';  &#13;&#10;  end else if cbOrg.Checked then begin&#13;&#10;    sName:='Административные процедуры для организаций';                                                          &#13;&#10;    s:='adm_proc&#62;10000';&#13;&#10;  end else begin&#13;&#10;    DialogPage1.ModalResult:=mrCancel;&#13;&#10;  end;&#13;&#10;    &#13;&#10;  sName:=sName+' за период с '+DatePropis(DateEdit1.Date,3)+' по '+DatePropis(DateEdit2.Date,3);                                                          &#13;&#10;  if s&#60;&#62;''&#13;&#10;    then Query.SQL.text:=Replace(Query.SQL.text,'1=1',s);&#13;&#10;&#13;&#10;  if edProc.text&#60;&#62;'' then begin                     &#13;&#10;    Query.SQL.text:=Query.SQL.text+chr(13)+chr(10)+&#13;&#10;    'where iif(adm_proc&#62;10000, sa2.proc_no, sa1.proc_no) LIKE '+QStr(edProc.text+'%');&#13;&#10;  end;&#13;&#10;  Query.SQL.text:=Query.SQL.text+chr(13)+chr(10)+'order by proc_type, iif(adm_proc&#62;10000, sa2.hi_code, sa1.hi_code)';&#13;&#10;    &#13;&#10;//  showmessage(Query.SQL.text);                                              &#13;&#10;  SetLastValue('ADM_MEN',cbMen.Checked, 'L');&#13;&#10;  SetLastValue('ADM_ORG',cbOrg.Checked, 'L');  &#13;&#10;    &#13;&#10;end;&#13;&#10;&#13;&#10;procedure DialogPage1OnActivate(Sender: TfrxComponent);&#13;&#10;begin&#13;&#10;  DateEdit1.Date:=Date;  &#13;&#10;  DateEdit2.Date:=Date;        &#13;&#10;  &#13;&#10;  cbMen.Checked:=GetLastValue('ADM_MEN','L');&#13;&#10;  cbOrg.Checked:=GetLastValue('ADM_ORG','L');&#13;&#10;  if not cbMen.Checked and not cbOrg.Checked then begin&#13;&#10;    cbMen.Checked:=true;&#13;&#10;  end;              &#13;&#10;end;&#13;&#10;&#13;&#10;begin&#13;&#10;&#13;&#10;end." StoreInDFM="False" PropData="044C65667403A80203546F7003000108446174617365747301010C2400000020446174615365743D2251756572792220446174615365744E616D653D225175657279220000095661726961626C65730100055374796C650100">
  <TfrxDataPage Name="Data" Height="1000" Left="0" Top="0" Width="1000">
    <TfrxADSQuery Name="Query" UserName="Query" CloseDataSource="True" FieldAliases.Text="" BCDToCurrency="False" IgnoreDupParams="False" SQL.Text="select&#13;&#10;   iif(adm_proc&#62;10000, trim(sa2.proc_no), trim(sa1.proc_no)) nomer, &#13;&#10;   iif(adm_proc&#62;10000, trim(sa2.full_name), trim(sa1.full_name)) name, &#13;&#10;   adm_proc, kolvo from&#13;&#10;(&#13;&#10;select&#13;&#10;   iif(adm_proc&#62;10000, 2, 1) proc_type,&#13;&#10;   adm_proc,&#13;&#10;   Count(*) kolvo&#13;&#10;from DOCMAIN d&#13;&#10;where doc_type=5 and reg_date&#62;=:strDate1 and reg_date&#60;=:strDate2 and 1=1&#13;&#10;group by 1,2 ) aaa&#13;&#10;  left join sysspr.SprDocAdmProc sa1 on sa1.ID=aaa.adm_proc&#13;&#10;  left join sysspr.SprDocAdmProcU sa2 on sa2.ID=aaa.adm_proc" SourceTableType="ttAdsADT" CharType="ANSI" RequestLive="False" PropData="05704C6566740381000470546F7002740A506172616D657465727301010C39000000204E616D653D227374724461746531222044617461547970653D226674556E6B6E6F776E222045787072657373696F6E3D227344617465312200010C39000000204E616D653D227374724461746532222044617461547970653D226674556E6B6E6F776E222045787072657373696F6E3D22734461746532220000"/>
  </TfrxDataPage>
  <TfrxDialogPage Name="DialogPage1" Font.Charset="1" Font.Color="0" Font.Height="-11" Font.Name="Tahoma" Font.Style="0" BorderStyle="bsDialog" Caption="Выходная форма" Height="226" ClientHeight="188" Left="381" Top="218" Width="433" ClientWidth="417" OnActivate="DialogPage1OnActivate">
    <TfrxCheckBoxControl Name="cbMen" Left="12" Top="11" Width="402" Height="17" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Административные процедуры для граждан" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxCheckBoxControl Name="cbOrg" Left="12" Top="35" Width="399" Height="17" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Административные процедуры для организаций" Checked="True" State="cbChecked" Color="-16777201"/>
    <TfrxLabelControl Name="Label1" Left="12" Top="93" Width="95" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Начальная дата" Color="-16777201"/>
    <TfrxDateEditControl Name="DateEdit1" Left="154" Top="91" Width="145" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="43025.7105584028" Time="43025.7105584028" WeekNumbers="False"/>
    <TfrxLabelControl Name="Label2" Left="12" Top="121.5" Width="87" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Конечная дата" Color="-16777201"/>
    <TfrxDateEditControl Name="DateEdit2" Left="154" Top="119" Width="145" Height="21" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Color="-16777211" Date="43025.7105584028" Time="43025.7105584028" WeekNumbers="False"/>
    <TfrxButtonControl Name="Button1" Left="228" Top="154" Width="75" Height="25" ShowHint="True" Caption="Выполнить" ModalResult="1" OnClick="Button1OnClick"/>
    <TfrxButtonControl Name="Button2" Left="323" Top="155" Width="75" Height="25" ShowHint="True" Caption="Отказ" ModalResult="2"/>
    <TfrxEditControl Name="edProc" Left="154" Top="63" Width="62" Height="21" ShowHint="True" Color="-16777211" MaxLength="0" PasswordChar="0"/>
    <TfrxLabelControl Name="Label3" Left="12" Top="64" Width="63" Height="16" Font.Charset="1" Font.Color="0" Font.Height="-13" Font.Name="Tahoma" Font.Style="0" ParentFont="False" ShowHint="True" Caption="Процедура" Color="-16777201"/>
  </TfrxDialogPage>
  <TfrxReportPage Name="Page1" PaperWidth="210" PaperHeight="297" PaperSize="9" LeftMargin="5.29166666666667" RightMargin="0" TopMargin="5.29166666666667" BottomMargin="0" ColumnWidth="0" ColumnPositions.Text="" HGuides.Text="" VGuides.Text="" OnAfterPrint="Page1OnAfterPrint" OnBeforePrint="Page1OnBeforePrint">
    <TfrxReportTitle Name="ReportTitle1" Height="60.83333333" Left="0" Top="16" Width="773.701287083333">
      <TfrxMemoView Name="Memo1" Left="11.66666667" Top="3.33333333" Width="725" Height="52.5" ShowHint="False" Font.Charset="1" Font.Color="0" Font.Height="-19" Font.Name="Times New Roman" Font.Style="0" ParentFont="False" Text="[NameOrg()]&#13;&#10;[sName]"/>
    </TfrxReportTitle>
    <TfrxMasterData Name="MasterData1" Height="20" Left="0" Top="136" Width="773.701287083333" ColumnWidth="0" ColumnGap="0" DataSet="Query" DataSetName="Query" RowCount="0" Stretched="True">
      <TfrxMemoView Name="Querynomer" ShiftMode="smDontShift" Left="9" Top="0" Width="70" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataField="nomer" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Query.&#34;nomer&#34;]"/>
      <TfrxMemoView Name="Queryname" ShiftMode="smDontShift" Left="79" Top="0" Width="582" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataField="name" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="[Query.&#34;name&#34;]"/>
      <TfrxMemoView Name="Querykolvo" ShiftMode="smDontShift" Left="661" Top="0" Width="72" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataField="kolvo" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[Query.&#34;kolvo&#34;]"/>
    </TfrxMasterData>
    <TfrxReportSummary Name="ReportSummary1" Height="20" Left="0" Top="216" Width="773.701287083333">
      <TfrxMemoView Name="Memo3" ShiftMode="smDontShift" Left="661" Top="0" Width="72" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" HAlign="haRight" ParentFont="False" Text="[SUM(&#60;Query.&#34;kolvo&#34;&#62;,0,1)]"/>
      <TfrxMemoView Name="Memo2" ShiftMode="smDontShift" Left="9" Top="0" Width="652" Height="20" ShowHint="False" StretchMode="smMaxHeight" DataSet="Query" DataSetName="Query" Font.Charset="1" Font.Color="0" Font.Height="-16" Font.Name="Times New Roman" Font.Style="0" Frame.Typ="15" ParentFont="False" Text="РС‚РѕРіРѕ"/>
    </TfrxReportSummary>
  </TfrxReportPage>
</TfrxReport>
